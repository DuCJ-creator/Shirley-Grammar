<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shirley's Inversion (Radial Design)</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* é…è‰²æ–¹æ¡ˆï¼šGeneral of the Deep (æ·±æµ·è— & é¦™æª³é‡‘) */
            --bg-deep: #f0f4f8;       /* æ·ºè—ç°èƒŒæ™¯ */
            --primary: #0c2d48;       /* æ·±æµ·è— */
            --primary-dark: #051929;  /* åˆå¤œè— */
            --accent: #d4af37;        /* é¦™æª³é‡‘ */
            
            --card-bg: rgba(255, 255, 255, 0.98);
            --shadow-float: 0 10px 40px -10px rgba(12, 45, 72, 0.2);
            --highlight-bg: #fffcf5;

            /* æ¸¬é©—å°ˆç”¨è‰² */
            --correct-bg: #d4edda;
            --correct-text: #155724;
            --wrong-bg: #f8d7da;
            --wrong-text: #721c24;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Lato', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-deep);
            color: #2c3e50;
            overflow: hidden; 
            height: 100vh; width: 100vw;
        }

        /* --- 1. Radial Mind Map (æ”¾å°„ç‹€é¦–é ) --- */
        #mindmap-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            z-index: 1;
        }

        /* ä¸­å¿ƒç¯€é» */
        .central-node {
            width: 200px; height: 200px;
            background: var(--primary);
            border-radius: 50%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            color: white;
            box-shadow: 0 0 50px rgba(12, 45, 72, 0.5);
            z-index: 10;
            position: relative;
            animation: pulse 3s infinite ease-in-out;
            text-align: center;
            border: 5px solid var(--accent);
            cursor: default;
        }

        .central-title { font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 700; line-height: 1.2; }
        .central-sub { font-size: 0.9rem; opacity: 0.9; margin-top: 5px; font-weight: 300; letter-spacing: 1px; color: #e0e0e0; }

        /* è¡›æ˜Ÿç¯€é» */
        .satellite {
            position: absolute;
            width: 110px; height: 110px;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 50%;
            color: var(--primary);
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-size: 0.8rem; font-weight: 600;
            z-index: 5;
            padding: 5px;
        }
        
        .satellite i { font-size: 1.6rem; margin-bottom: 5px; color: var(--accent); }
        .satellite span { font-size: 0.7rem; opacity: 0.8; display: block; margin-top: 2px; color: #555; }

        .satellite:hover {
            transform: scale(1.15) !important;
            background: var(--primary);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 10px 25px rgba(12, 45, 72, 0.3);
            z-index: 20;
        }
        .satellite:hover i { color: var(--accent); }
        .satellite:hover span { color: rgba(255,255,255,0.9); }

        /* æ¸¬é©—ç¯€é»æ¨£å¼ */
        .satellite.quiz-node { border-color: var(--accent); }
        .satellite.quiz-node i { color: var(--primary); }
        .satellite.quiz-node:hover { background: var(--accent); border-color: var(--primary); }
        .satellite.quiz-node:hover i { color: var(--primary); }

        /* é€£æ¥ç·š */
        .connections { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; }
        .conn-line { stroke: var(--accent); stroke-width: 1.5; stroke-dasharray: 4,4; opacity: 0.5; }

        /* --- 2. Modal (å…§å®¹å¡ç‰‡) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(5, 25, 41, 0.4);
            backdrop-filter: blur(5px);
            z-index: 100;
            opacity: 0; visibility: hidden;
            transition: all 0.4s ease;
            display: flex; justify-content: center; align-items: center;
        }

        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal-card {
            width: 90%; max-width: 1000px; height: 90vh;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-float);
            display: flex; flex-direction: column;
            overflow: hidden;
            transform: translateY(30px) scale(0.95);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal-overlay.active .modal-card { transform: translateY(0) scale(1); }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), #1a4b70);
            color: white;
            padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 4px solid var(--accent);
        }
        
        .modal-title h2 { font-family: 'Playfair Display', serif; font-size: 1.6rem; margin: 0; border: none; padding: 0; color: white; }
        .modal-close { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; transition: 0.3s; }
        .modal-close:hover { transform: rotate(90deg); color: var(--accent); }

        /* åˆ†é å°èˆª */
        .modal-tabs {
            display: flex; background: #fffcf5; overflow-x: auto;
            border-bottom: 1px solid #efe5d9; flex-shrink: 0;
        }
        .tab-btn {
            flex: 1; padding: 1rem; border: none; background: none;
            color: #555; font-weight: 600; cursor: pointer;
            transition: 0.3s; min-width: 120px; white-space: nowrap;
            font-family: 'Lato', sans-serif; font-size: 0.95rem;
        }
        .tab-btn:hover { background: #f0f4f8; color: var(--primary); }
        .tab-btn.active { background: white; color: var(--primary); border-bottom: 3px solid var(--primary); }

        /* å…§å®¹æ¨£å¼ */
        .modal-body { flex: 1; overflow-y: auto; padding: 2.5rem; scroll-behavior: smooth; line-height: 1.8; }
        
        h2 { font-family: 'Playfair Display', serif; color: var(--primary); font-size: 1.8rem; border-bottom: 1px solid rgba(12, 45, 72, 0.2); padding-bottom: 0.8rem; margin-bottom: 1.5rem; }
        h3 { color: #2c3e50; font-size: 1.3rem; margin: 1.5rem 0 1rem; font-weight: 700; display: flex; align-items: center; }
        h3 i { color: var(--accent); margin-right: 10px; font-size: 1.1rem; }

        .grammar-formula {
            background: #f0f4f8;
            padding: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 1rem;
            border-left: 4px solid var(--accent);
        }

        .example-list { list-style: none; }
        .example-item {
            margin-bottom: 1.5rem;
            padding-left: 1rem;
            position: relative;
            background: white;
            border: 1px solid #eee;
            border-left: 3px solid #ddd;
            padding: 15px;
            border-radius: 0 6px 6px 0;
            transition: all 0.3s;
        }
        .example-item:hover { border-left-color: var(--accent); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }

        .en-sentence { font-size: 1.1rem; color: #2c3e50; font-weight: 600; margin-bottom: 5px; }
        .cn-trans { font-size: 0.95rem; color: #7f8c8d; }
        .highlight-gold { color: var(--primary); font-weight: bold; background-color: rgba(212, 175, 55, 0.2); padding: 0 4px; border-radius: 2px; }

        .audio-btn { background: none; border: none; color: var(--accent); cursor: pointer; margin-left: 8px; font-size: 1.1rem; transition: all 0.2s; }
        .audio-btn:hover { color: var(--primary); transform: scale(1.15); }

        /* Quiz Styles */
        .quiz-container { max-width: 800px; margin: 0 auto; }
        .quiz-progress { margin-bottom: 1.5rem; color: #666; font-weight: 700; text-align: right; }
        .quiz-card-q { background: white; border-radius: 8px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .quiz-question { font-size: 1.2rem; font-weight: 700; color: var(--primary); margin-bottom: 1.5rem; border-left: 4px solid var(--accent); padding-left: 20px; line-height: 1.6; }
        .quiz-options { display: grid; gap: 12px; }
        .quiz-option { padding: 15px 20px; background: white; border: 2px solid #eef2f5; border-radius: 8px; cursor: pointer; transition: 0.2s; font-weight: 600; text-align: left; font-size: 1rem; }
        .quiz-option:hover:not(.disabled) { border-color: var(--primary); background: #f0f4f8; }
        .quiz-option.correct { background-color: var(--correct-bg); border-color: #28a745; color: var(--correct-text); }
        .quiz-option.incorrect { background-color: var(--wrong-bg); border-color: #dc3545; color: var(--wrong-text); opacity: 0.8; }
        .quiz-option.disabled { cursor: default; pointer-events: none; }
        
        .quiz-explanation { margin-top: 20px; padding: 15px; background: rgba(212, 175, 55, 0.1); border-radius: 8px; border-left: 4px solid var(--accent); display: none; }
        .next-btn { margin-top: 20px; background: var(--primary); color: white; border: none; padding: 10px 25px; border-radius: 30px; cursor: pointer; display: none; font-weight: bold; box-shadow: 0 4px 10px rgba(12, 45, 72, 0.3); }
        
        .score-circle { width: 140px; height: 140px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 2rem; color: white; font-size: 3rem; font-weight: 800; box-shadow: 0 10px 30px rgba(12, 45, 72, 0.3); border: 4px solid var(--accent); }

        @keyframes pulse { 0%, 100% { box-shadow: 0 0 50px rgba(12, 45, 72, 0.4); } 50% { box-shadow: 0 0 70px rgba(12, 45, 72, 0.7); } }
    </style>
</head>
<body>

    <div id="mindmap-container">
        <svg class="connections" id="lines-svg"></svg>
        
        <div class="central-node">
            <div class="central-title">Shirley's Inversion</div>
            <div class="central-sub">å€’è£å¥çµæ§‹</div>
        </div>

        <div class="satellite" onclick="openModal('intro')">
            <i class="fas fa-book-open"></i>
            <div>æ¦‚è«–<br><span>Intro</span></div>
        </div>
        <div class="satellite" onclick="openModal('negative')">
            <i class="fas fa-ban"></i>
            <div>å¦å®šå‰¯è©<br><span>Negative</span></div>
        </div>
        <div class="satellite" onclick="openModal('only')">
            <i class="fas fa-bullseye"></i>
            <div>Onlyé–‹é ­<br><span>Only</span></div>
        </div>
        <div class="satellite" onclick="openModal('place')">
            <i class="fas fa-map-marker-alt"></i>
            <div>åœ°æ–¹/æ–¹å‘<br><span>Place</span></div>
        </div>
        <div class="satellite" onclick="openModal('conditional')">
            <i class="fas fa-code-branch"></i>
            <div>å‡è¨­èªæ°£<br><span>If</span></div>
        </div>
        <div class="satellite" onclick="openModal('degree')">
            <i class="fas fa-tachometer-alt"></i>
            <div>ç¨‹åº¦ (So/Such)<br><span>Degree</span></div>
        </div>
        <div class="satellite quiz-node" onclick="openModal('quiz')">
            <i class="fas fa-pencil-alt"></i>
            <div>è‡ªæˆ‘æª¢æ¸¬<br><span>Quiz (20)</span></div>
        </div>
    </div>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-card">
            <header class="modal-header">
                <div class="modal-title"><h2>Shirley's Inversion Platform</h2></div>
                <button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
            </header>
            <nav class="modal-tabs" id="modal-tabs"></nav>
            <div class="modal-body" id="modal-content"></div>
        </div>
    </div>

    <script>
        // --- 1. CONTENT DATA ---
        const contentData = {
            intro: {
                title: "æ¦‚è«– (Introduction)",
                html: `
                <h2>ä»€éº¼æ˜¯å€’è£å¥ï¼Ÿ</h2>
                <p>å€’è£å¥ (Inversion) æ˜¯æŒ‡å°‡å¥å­ä¸­çš„<strong>å‹•è© (Verb)</strong> æˆ– <strong>åŠ©å‹•è© (Auxiliary)</strong> ç§»åˆ° <strong>ä¸»è© (Subject)</strong> ä¹‹å‰çš„å¥å‹ã€‚ç›®çš„æ˜¯ç‚ºäº†å¼·èª¿èªæ°£æˆ–ä¿®è¾­çš„ç”Ÿå‹•æ€§ã€‚</p>
                
                <div class="grammar-formula">
                    æ­£å¸¸èªåºï¼šSubject + Verb ...<br>
                    å€’è£èªåºï¼šAuxiliary / Verb + Subject ...
                </div>

                <h3><i class="fas fa-layer-group"></i> å…©å¤§é¡å‹</h3>
                <ul class="example-list">
                    <li class="example-item">
                        <div class="en-sentence"><strong>1. éƒ¨åˆ†å€’è£ (Partial Inversion)</strong></div>
                        <p>åŠ©å‹•è©ç§»è‡³ä¸»è©å‰ (Aux + S + V)ã€‚é€šå¸¸ç”¨æ–¼å¦å®šå‰¯è©ã€Onlyç­‰ã€‚</p>
                        <div class="en-sentence">Example: Never <span class="highlight-gold">have I</span> seen him.</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>2. å®Œå…¨å€’è£ (Full Inversion)</strong></div>
                        <p>æ•´å€‹å‹•è©ç§»è‡³ä¸»è©å‰ (V + S)ã€‚é€šå¸¸ç”¨æ–¼åœ°æ–¹å‰¯è©ã€‚</p>
                        <div class="en-sentence">Example: Here <span class="highlight-gold">comes the bus</span>.</div>
                    </li>
                </ul>`
            },
            negative: {
                title: "å¦å®šå‰¯è© (Negative)",
                html: `
                <h2>å¦å®šå‰¯è©æ”¾å¥é¦– (éƒ¨åˆ†å€’è£)</h2>
                <p>ç•¶å¦å®šæ„ç¾©çš„å‰¯è©ä½æ–¼å¥é¦–æ™‚ï¼Œç‚ºäº†åŠ å¼·èªæ°£ï¼Œå¥å­å¿…é ˆå€’è£ã€‚</p>
                <div class="grammar-formula">Negative Adv + Aux + S + V</div>

                <h3><i class="fas fa-list-ul"></i> å¸¸ç”¨å¦å®šè©</h3>
                <ul class="example-list">
                    <li class="example-item">
                        <div class="en-sentence"><strong>Never:</strong> Never <span class="highlight-gold">have I</span> seen such a beautiful sunset. <button class="audio-btn" onclick="speak('Never have I seen such a beautiful sunset.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">æˆ‘å¾æœªè¦‹éå¦‚æ­¤ç¾éº—çš„æ—¥è½ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Seldom:</strong> Seldom <span class="highlight-gold">does she</span> complain. <button class="audio-btn" onclick="speak('Seldom does she complain.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">å¥¹å¾ˆå°‘æŠ±æ€¨ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Hardly:</strong> Hardly <span class="highlight-gold">had I</span> arrived when it rained. <button class="audio-btn" onclick="speak('Hardly had I arrived when it rained.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">æˆ‘å‰›åˆ°é”å°±ä¸‹é›¨äº†ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Little:</strong> Little <span class="highlight-gold">did he</span> know about the surprise. <button class="audio-btn" onclick="speak('Little did he know about the surprise.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">ä»–å°é€™å€‹é©šå–œä¸€é»ä¹Ÿä¸çŸ¥é“ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Nowhere:</strong> Nowhere <span class="highlight-gold">will you</span> find a better friend. <button class="audio-btn" onclick="speak('Nowhere will you find a better friend.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">ä½ åœ¨ä»»ä½•åœ°æ–¹éƒ½æ‰¾ä¸åˆ°æ¯”ä»–æ›´å¥½çš„æœ‹å‹ã€‚</div>
                    </li>
                </ul>`
            },
            only: {
                title: "Only é–‹é ­",
                html: `
                <h2>Only + ç‹€èªæ”¾å¥é¦–</h2>
                <p>ç•¶ "Only" åŠ ä¸Šå‰¯è©ã€ä»‹ç³»è©ç‰‡èªæˆ–ç‹€èªå­å¥ä½æ–¼å¥é¦–æ™‚ï¼Œä¸»è¦å­å¥éœ€å€’è£ã€‚</p>
                <div class="grammar-formula">Only + (Time/Prep/Clause) + Aux + S + V</div>

                <ul class="example-list">
                    <li class="example-item">
                        <div class="en-sentence"><strong>Only recently</strong> <span class="highlight-gold">did I</span> realize my mistake. <button class="audio-btn" onclick="speak('Only recently did I realize my mistake.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">ç›´åˆ°æœ€è¿‘æˆ‘æ‰æ„è­˜åˆ°æˆ‘çš„éŒ¯èª¤ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Only by working hard</strong> <span class="highlight-gold">can you</span> succeed. <button class="audio-btn" onclick="speak('Only by working hard can you succeed.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">åªæœ‰åŠªåŠ›å·¥ä½œï¼Œä½ æ‰èƒ½æˆåŠŸã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Only when</strong> you grow up <span class="highlight-gold">will you</span> understand. <button class="audio-btn" onclick="speak('Only when you grow up will you understand.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">åªæœ‰ç•¶ä½ é•·å¤§å¾Œï¼Œä½ æ‰æœƒæ˜ç™½ã€‚(å€’è£åœ¨ä¸»è¦å­å¥)</div>
                    </li>
                </ul>`
            },
            place: {
                title: "åœ°æ–¹/æ–¹å‘ (Place)",
                html: `
                <h2>åœ°æ–¹èˆ‡æ–¹å‘å‰¯è© (å®Œå…¨å€’è£)</h2>
                <p>ç‚ºäº†ç”Ÿå‹•æè¿°ï¼Œå°‡åœ°é»å‰¯è©ç§»è‡³å¥é¦–ï¼Œä½¿ç”¨å®Œå…¨å€’è£ (V + S)ã€‚</p>
                <div class="grammar-formula">Place/Direction + Verb + Subject</div>

                <ul class="example-list">
                    <li class="example-item">
                        <div class="en-sentence"><strong>Here</strong> <span class="highlight-gold">comes the bus</span>. <button class="audio-btn" onclick="speak('Here comes the bus.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">å…¬è»Šä¾†äº†ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Under the tree</strong> <span class="highlight-gold">sat a boy</span>. <button class="audio-btn" onclick="speak('Under the tree sat a boy.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">æ¨¹ä¸‹åè‘—ä¸€å€‹ç”·å­©ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Away</strong> <span class="highlight-gold">flew the birds</span>. <button class="audio-btn" onclick="speak('Away flew the birds.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">é³¥å…’é£›èµ°äº†ã€‚</div>
                    </li>
                </ul>

                <div style="background:#fff3cd; padding:1rem; border-radius:4px; margin-top:1rem; border:1px solid #ffeeba;">
                    <strong style="color:#856404;"><i class="fas fa-exclamation-triangle"></i> é‡è¦ä¾‹å¤–ï¼š</strong>
                    <p style="font-size:0.95rem; color:#856404;">å¦‚æœä¸»è©æ˜¯<strong>ä»£åè© (Pronoun)</strong>ï¼Œå‰‡<strong>ä¸å€’è£</strong>ã€‚</p>
                    <div class="en-sentence">Here <span style="text-decoration:underline;">it comes</span>. <button class="audio-btn" onclick="speak('Here it comes.')"><i class="fas fa-volume-up"></i></button> (O)</div>
                </div>`
            },
            conditional: {
                title: "å‡è¨­èªæ°£ (If)",
                html: `
                <h2>çœç•¥ If çš„å‡è¨­èªæ°£</h2>
                <p>åœ¨å‡è¨­èªæ°£ä¸­ï¼Œçœç•¥ If å¾Œï¼Œå°‡åŠ©å‹•è© (Were, Had, Should) ç§»è‡³ä¸»è©å‰ã€‚</p>

                <ul class="example-list">
                    <li class="example-item">
                        <h3>Type 1: Were (èˆ‡ç¾åœ¨äº‹å¯¦ç›¸å)</h3>
                        <div class="en-sentence"><span class="highlight-gold">Were I</span> you, I would go. <button class="audio-btn" onclick="speak('Were I you, I would go.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">= If I were you...</div>
                    </li>
                    <li class="example-item">
                        <h3>Type 2: Had (èˆ‡éå»äº‹å¯¦ç›¸å)</h3>
                        <div class="en-sentence"><span class="highlight-gold">Had I known</span>, I would have told you. <button class="audio-btn" onclick="speak('Had I known, I would have told you.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">= If I had known...</div>
                    </li>
                    <li class="example-item">
                        <h3>Type 3: Should (è¬ä¸€)</h3>
                        <div class="en-sentence"><span class="highlight-gold">Should it rain</span>, we will cancel. <button class="audio-btn" onclick="speak('Should it rain, we will cancel.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">= If it should rain...</div>
                    </li>
                </ul>`
            },
            degree: {
                title: "ç¨‹åº¦ (So/Such)",
                html: `
                <h2>So / Such ... that (ç¨‹åº¦å‰¯è©å¼·èª¿)</h2>
                <p>å°‡ "So + Adj/Adv" æˆ– "Such" ç§»è‡³å¥é¦–å¼·èª¿ç¨‹åº¦ï¼Œå¥å­å€’è£ã€‚</p>

                <ul class="example-list">
                    <li class="example-item">
                        <div class="en-sentence"><strong>So fast</strong> <span class="highlight-gold">did he run</span> that no one could catch him. <button class="audio-btn" onclick="speak('So fast did he run that no one could catch him.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">ä»–è·‘å¾—é‚£éº¼å¿«ï¼Œæ²’äººèƒ½æŠ“åˆ°ä»–ã€‚</div>
                    </li>
                    <li class="example-item">
                        <div class="en-sentence"><strong>Such</strong> <span class="highlight-gold">was his anger</span> that he lost control. <button class="audio-btn" onclick="speak('Such was his anger that he lost control.')"><i class="fas fa-volume-up"></i></button></div>
                        <div class="cn-trans">ä»–æ†¤æ€’åˆ°å¤±å»äº†æ§åˆ¶ã€‚</div>
                    </li>
                </ul>`
            },
            quiz: {
                title: "è‡ªæˆ‘æª¢æ¸¬",
                html: `<div id="quiz-interface" class="quiz-container">
                    <div class="quiz-progress">Question <span id="current-question-num">1</span> of 20</div>
                    <div id="quiz-question-container"></div>
                </div>
                <div id="quiz-score" class="quiz-result" style="display: none;">
                    <div class="score-circle" id="score-val">0</div>
                    <h2>Quiz Completed!</h2>
                    <p id="score-msg" style="margin:20px 0; font-size:1.1rem; color:#666;"></p>
                    <button class="next-btn" style="display:inline-block;" onclick="initQuiz()"><i class="fas fa-redo"></i> Restart Quiz</button>
                </div>`
            }
        };

        // --- 2. QUIZ DATA ---
        const quizQuestions = [
            { question: "1. Never ______ such a beautiful sight.", options: ["I have seen", "have I seen", "I saw", "saw I"], correct: 1, explanation: "Negative adverb 'Never' requires partial inversion." },
            { question: "2. Seldom ______ late for work.", options: ["is she", "she is", "does she", "she does"], correct: 0, explanation: "'Seldom' requires inversion. 'Is she' is correct for 'She is late'." },
            { question: "3. Hardly had I arrived ______ it started to rain.", options: ["than", "when", "then", "after"], correct: 1, explanation: "Structure: 'Hardly... when...'." },
            { question: "4. Only by practicing ______ you improve.", options: ["can", "you can", "can't", "you will"], correct: 0, explanation: "'Only' + prep phrase requires inversion." },
            { question: "5. Not only ______ smart, but he is also kind.", options: ["he is", "is he", "does he", "he does"], correct: 1, explanation: "'Not only' requires inversion." },
            { question: "6. Here ______ the bus!", options: ["comes", "come", "is coming", "does come"], correct: 0, explanation: "Full inversion with noun subject: 'Here comes the bus'." },
            { question: "7. Here ______.", options: ["comes it", "it comes", "does it come", "is it coming"], correct: 1, explanation: "No inversion with pronoun subject 'it'." },
            { question: "8. ______ you, I would study harder.", options: ["If I was", "Were I", "Was I", "Am I"], correct: 1, explanation: "Conditional Type 2: 'Were I' = 'If I were'." },
            { question: "9. ______ I known the truth, I would have told you.", options: ["Have", "Had", "Did", "If"], correct: 1, explanation: "Conditional Type 3: 'Had I known' = 'If I had known'." },
            { question: "10. ______ it rain tomorrow, we will stay home.", options: ["Should", "If", "Were", "Had"], correct: 0, explanation: "Inversion for 'If it should rain' is 'Should it rain'." },
            { question: "11. So fast ______ that he won the race.", options: ["he ran", "did he run", "he runs", "does he run"], correct: 1, explanation: "'So + adv' requires inversion." },
            { question: "12. Under the tree ______ a cat.", options: ["sleeping", "slept", "did sleep", "was sleeping"], correct: 1, explanation: "Full inversion: 'slept a cat'." },
            { question: "13. Little ______ know about the surprise.", options: ["did he", "he did", "does he", "he does"], correct: 0, explanation: "'Little' (negative) requires inversion." },
            { question: "14. No sooner had we left ______ it began to snow.", options: ["when", "than", "then", "that"], correct: 1, explanation: "Structure: 'No sooner... than...'." },
            { question: "15. Nowhere ______ find a better deal.", options: ["you will", "will you", "you can", "can you not"], correct: 1, explanation: "'Nowhere' requires inversion." },
            { question: "16. Only when you are older ______ understand.", options: ["you will", "will you", "do you", "you do"], correct: 1, explanation: "'Only' + clause requires inversion in main clause." },
            { question: "17. Such ______ his strength that he lifted the car.", options: ["is", "was", "has", "had"], correct: 1, explanation: "'Such' requires inversion. Past context implies 'was'." },
            { question: "18. Barely ______ started speaking when he was interrupted.", options: ["he had", "had he", "did he", "he did"], correct: 1, explanation: "'Barely' requires inversion." },
            { question: "19. On no account ______ this button be pressed.", options: ["should", "you should", "should not", "you must"], correct: 0, explanation: "'On no account' (negative) requires inversion." },
            { question: "20. Away ______ the birds.", options: ["flew", "did fly", "flown", "flying"], correct: 0, explanation: "Directional adverb 'Away' allows full inversion: 'Away flew the birds'." }
        ];

        // --- 3. SYSTEM LOGIC ---
        function layoutSatellites() {
            const satellites = document.querySelectorAll('.satellite');
            const svg = document.getElementById('lines-svg');
            while (svg.firstChild) svg.removeChild(svg.firstChild);

            const radius = 230; 
            const startAngle = -90; 
            const total = satellites.length;
            const cx = window.innerWidth / 2;
            const cy = window.innerHeight / 2;

            satellites.forEach((sat, i) => {
                const angle = startAngle + (i * (360 / total));
                const rad = angle * (Math.PI / 180);
                const x = Math.cos(rad) * radius;
                const y = Math.sin(rad) * radius;

                sat.style.left = `calc(50% + ${x}px - 60px)`; 
                sat.style.top = `calc(50% + ${y}px - 60px)`;

                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", "50%"); line.setAttribute("y1", "50%");
                line.setAttribute("x2", cx + x); line.setAttribute("y2", cy + y);
                line.classList.add("conn-line");
                svg.appendChild(line);
            });
        }
        
        window.addEventListener('resize', layoutSatellites);
        window.addEventListener('load', layoutSatellites);

        const tabKeys = ['intro', 'negative', 'only', 'place', 'conditional', 'degree', 'quiz'];

        function openModal(activeKey) {
            const modal = document.getElementById('modal-overlay');
            const tabsContainer = document.getElementById('modal-tabs');
            
            tabsContainer.innerHTML = tabKeys.map(key => {
                const isQuiz = key === 'quiz';
                return `<button class="tab-btn ${key === activeKey ? 'active' : ''}" 
                        onclick="switchTab('${key}', this)">
                        ${isQuiz ? '<i class="fas fa-pencil-alt"></i> ' : ''}${contentData[key].title}
                        </button>`;
            }).join('');

            loadContent(activeKey);
            modal.classList.add('active');
        }

        function closeModal() { document.getElementById('modal-overlay').classList.remove('active'); }

        function switchTab(key, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            loadContent(key);
        }

        function loadContent(key) {
            const contentDiv = document.getElementById('modal-content');
            contentDiv.innerHTML = contentData[key].html;
            if(key === 'quiz') initQuiz();
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text);
                u.lang = 'en-US'; u.rate = 0.9;
                window.speechSynthesis.speak(u);
            }
        }

        // Quiz Logic
        let currentQIndex = 0;
        let score = 0;
        let answered = false;

        function initQuiz() {
            currentQIndex = 0; score = 0;
            document.getElementById('quiz-interface').style.display = 'block';
            document.getElementById('quiz-score').style.display = 'none';
            showQuestion(0);
        }

        function showQuestion(index) {
            answered = false;
            const container = document.getElementById('quiz-question-container');
            const q = quizQuestions[index];
            
            container.innerHTML = `
                <div class="quiz-card-q">
                    <div class="quiz-question">${q.question}</div>
                    <div class="quiz-options">
                        ${q.options.map((opt, i) => `
                            <div class="quiz-option" onclick="handleAnswer(this, ${i})">${opt}</div>
                        `).join('')}
                    </div>
                    <div class="quiz-explanation" id="explanation">${q.explanation}</div>
                    <button class="next-btn" id="next-btn" onclick="nextQ()">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            `;
            document.getElementById('current-question-num').innerText = index + 1;
        }

        function handleAnswer(btn, selectedIndex) {
            if (answered) return;
            answered = true;
            const q = quizQuestions[currentQIndex];
            const allBtns = document.querySelectorAll('.quiz-option');
            
            if (selectedIndex === q.correct) {
                btn.classList.add('correct');
                score++;
            } else {
                btn.classList.add('incorrect');
                allBtns[q.correct].classList.add('correct');
            }
            
            allBtns.forEach(b => b.classList.add('disabled'));
            document.getElementById('explanation').style.display = 'block';
            document.getElementById('next-btn').style.display = 'inline-block';
        }

        function nextQ() {
            currentQIndex++;
            if (currentQIndex < quizQuestions.length) {
                showQuestion(currentQIndex);
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('quiz-interface').style.display = 'none';
            const resDiv = document.getElementById('quiz-score');
            resDiv.style.display = 'block';
            document.getElementById('score-val').innerText = score;
            const msg = document.getElementById('score-msg');
            
            if (score >= 18) msg.textContent = "Excellent! You are a master of Inversion! ğŸ†";
            else if (score >= 12) msg.textContent = "Good job! Keep practicing. ğŸ‘";
            else msg.textContent = "Review the rules and try again! ğŸ’ª";
        }
    </script>
</body>
</html>
