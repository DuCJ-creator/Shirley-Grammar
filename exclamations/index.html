<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shirley's Exclamations (Radial Design)</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* é…è‰²æ–¹æ¡ˆï¼šRoyal Burgundy (çš‡å®¶é…’ç´…) & Streamer Gold (æµå…‰é‡‘) */
            --bg-deep: #f9f7f2;       /* æš–ç™½èƒŒæ™¯ */
            --primary: #800020;       /* å‹ƒæ ¹åœ°é…’ç´… */
            --primary-dark: #4a0012;  /* æ·±é…’ç´… */
            --accent: #d4af37;        /* æµå…‰é‡‘ */
            
            --card-bg: rgba(255, 255, 255, 0.98);
            --shadow-float: 0 10px 40px -10px rgba(128, 0, 32, 0.15);
            --highlight-bg: #fffcf5;

            /* æ¸¬é©—å°ˆç”¨è‰² */
            --correct-bg: #d4edda;
            --correct-text: #155724;
            --wrong-bg: #f8d7da;
            --wrong-text: #721c24;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Lato', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-deep);
            color: #2c3e50;
            overflow: hidden; 
            height: 100vh; width: 100vw;
        }

        /* --- 1. Radial Mind Map (æ”¾å°„ç‹€é¦–é ) --- */
        #mindmap-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            z-index: 1;
        }

        /* ä¸­å¿ƒç¯€é» */
        .central-node {
            width: 210px; height: 210px;
            background: var(--primary);
            border-radius: 50%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            color: white;
            box-shadow: 0 0 50px rgba(128, 0, 32, 0.4);
            z-index: 10;
            position: relative;
            animation: pulse 3s infinite ease-in-out;
            text-align: center;
            border: 6px solid var(--accent);
            cursor: default;
        }

        .central-title { font-family: 'Playfair Display', serif; font-size: 1.6rem; font-weight: 700; line-height: 1.2; }
        .central-sub { font-size: 0.9rem; opacity: 0.9; margin-top: 5px; font-weight: 300; letter-spacing: 1px; color: #fffcf5; }

        /* è¡›æ˜Ÿç¯€é» */
        .satellite {
            position: absolute;
            width: 120px; height: 120px;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 50%;
            color: var(--primary);
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-size: 0.85rem; font-weight: 600;
            z-index: 5;
            padding: 5px;
        }
        
        .satellite i { font-size: 1.8rem; margin-bottom: 5px; color: var(--accent); }
        .satellite span { font-size: 0.7rem; opacity: 0.8; display: block; margin-top: 2px; color: #555; }

        .satellite:hover {
            transform: scale(1.15) !important;
            background: var(--primary);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 10px 25px rgba(128, 0, 32, 0.3);
            z-index: 20;
        }
        .satellite:hover i { color: var(--accent); }
        .satellite:hover span { color: rgba(255,255,255,0.9); }

        /* æ¸¬é©—ç¯€é»æ¨£å¼ */
        .satellite.quiz-node { border-color: var(--accent); }
        .satellite.quiz-node i { color: var(--primary); }
        .satellite.quiz-node:hover { background: var(--accent); border-color: var(--primary); }
        .satellite.quiz-node:hover i { color: var(--primary); }

        /* é€£æ¥ç·š */
        .connections { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; }
        .conn-line { stroke: var(--accent); stroke-width: 1.5; stroke-dasharray: 4,4; opacity: 0.5; }

        /* --- 2. Modal (å…§å®¹å¡ç‰‡) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(74, 0, 18, 0.4);
            backdrop-filter: blur(5px);
            z-index: 100;
            opacity: 0; visibility: hidden;
            transition: all 0.4s ease;
            display: flex; justify-content: center; align-items: center;
        }

        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal-card {
            width: 90%; max-width: 1000px; height: 90vh;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-float);
            display: flex; flex-direction: column;
            overflow: hidden;
            transform: translateY(30px) scale(0.95);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal-overlay.active .modal-card { transform: translateY(0) scale(1); }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), #961e38);
            color: white;
            padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 4px solid var(--accent);
        }
        
        .modal-title h2 { font-family: 'Playfair Display', serif; font-size: 1.6rem; margin: 0; border: none; padding: 0; color: white; }
        .modal-close { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; transition: 0.3s; }
        .modal-close:hover { transform: rotate(90deg); color: var(--accent); }

        /* åˆ†é å°èˆª */
        .modal-tabs {
            display: flex; background: #fffcf5; overflow-x: auto;
            border-bottom: 1px solid #efe5d9; flex-shrink: 0;
        }
        .tab-btn {
            flex: 1; padding: 1rem; border: none; background: none;
            color: #555; font-weight: 600; cursor: pointer;
            transition: 0.3s; min-width: 120px; white-space: nowrap;
            font-family: 'Lato', sans-serif; font-size: 0.95rem;
        }
        .tab-btn:hover { background: #fdf2f2; color: var(--primary); }
        .tab-btn.active { background: white; color: var(--primary); border-bottom: 3px solid var(--primary); }

        /* å…§å®¹æ¨£å¼ (ç§»æ¤è‡ªæ‚¨çš„åŸæª”) */
        .modal-body { flex: 1; overflow-y: auto; padding: 2.5rem; scroll-behavior: smooth; line-height: 1.8; }
        
        h2 { font-family: 'Playfair Display', serif; color: var(--primary); font-size: 1.8rem; border-bottom: 1px solid rgba(128, 0, 32, 0.2); padding-bottom: 0.8rem; margin-bottom: 1.5rem; }
        h3 { color: #5d4037; font-size: 1.3rem; margin: 1.5rem 0 1rem; font-weight: 700; }
        h4 { color: var(--accent); margin-bottom: 10px; font-weight: 700; }

        /* å¡ç‰‡èˆ‡ä¾‹å­ */
        .card { background: #fff; border-radius: 6px; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 2px 10px rgba(0,0,0,0.03); border: 1px solid #eee; position: relative; overflow: hidden; }
        .card::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background-color: var(--accent); opacity: 0.6; }
        
        .structure-box { background: linear-gradient(to right, #fffcf5, #fff); border: 1px solid var(--accent); border-radius: 6px; padding: 1.5rem; margin: 1.5rem 0; text-align: center; }
        .structure-title { color: var(--primary); font-family: 'Playfair Display', serif; font-weight: bold; font-size: 1.1rem; margin-bottom: 0.5rem; }
        .structure-content { font-family: 'Courier New', monospace; font-size: 1.1rem; color: #444; font-weight: 600; }
        
        .example { background-color: #f9f9f9; padding: 1rem; margin: 0.8rem 0; border-radius: 4px; font-style: italic; color: #555; border: 1px solid #eee; }
        .highlight { color: var(--primary); font-weight: bold; border-bottom: 2px solid rgba(212, 175, 55, 0.3); padding: 0 2px; }

        .qa-pair { display: flex; justify-content: space-between; margin: 15px 0; gap: 20px; }
        .question { flex: 1; padding: 1.2rem; background: #f4f4f4; border-radius: 6px; text-align: center; color: #666; }
        .answer { flex: 1; padding: 1.2rem; background: #fff0f3; border-radius: 6px; text-align: center; color: var(--primary); border: 1px solid rgba(128, 0, 32, 0.1); }
        
        .note-box { background-color: #fffcf5; border: 1px solid #ffeeba; color: #856404; padding: 1rem; border-radius: 4px; margin-top: 1rem; }

        .audio-btn { background: none; border: none; color: var(--accent); cursor: pointer; margin-left: 8px; font-size: 1.1rem; transition: all 0.2s; vertical-align: middle; }
        .audio-btn:hover { color: var(--primary); transform: scale(1.15); }

        /* Elegant Wrapper (ç§»æ¤) */
        .elegant-wrapper { background-color: #fdfbf7; padding: 2.5rem 2rem; border-radius: 8px; position: relative; margin-bottom: 2rem; border: 1px solid rgba(0,0,0,0.03); text-align: center; }
        .elegant-wrapper::before { content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 80px; height: 3px; background-color: var(--primary); }
        .elegant-title { font-family: 'Playfair Display', serif; font-size: 2.5rem; color: var(--primary); margin-bottom: 0.5rem; border: none; }
        .elegant-subtitle { font-family: 'Playfair Display', serif; font-style: italic; color: #888; margin-bottom: 2.5rem; display: block; }
        
        .elegant-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; }
        .elegant-card { background: #fff; border: 1px solid rgba(0,0,0,0.05); padding: 1.5rem; border-radius: 4px; transition: 0.3s; position: relative; }
        .elegant-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.08); border-color: var(--accent); }
        
        .elegant-icon-box { font-size: 1.5rem; color: white; background: var(--primary); width: 50px; height: 50px; line-height: 50px; border-radius: 50%; margin: 0 auto 1rem; box-shadow: 0 5px 15px rgba(128, 0, 32, 0.2); transition: 0.4s; }
        .elegant-card:hover .elegant-icon-box { background: var(--accent); transform: rotateY(180deg); }
        
        .card-heading { font-family: 'Playfair Display', serif; font-size: 1.2rem; color: #2c3e50; margin-bottom: 0.8rem; }
        .card-text { font-size: 0.9rem; color: #666; margin-bottom: 1rem; line-height: 1.5; }
        .divider-line { width: 30px; height: 1px; background-color: #ddd; margin: 1rem auto; transition: width 0.3s; }
        .elegant-card:hover .divider-line { width: 50px; background-color: var(--primary); }
        
        .detail-list li { list-style: none; text-align: left; font-size: 0.85rem; color: #555; display: flex; align-items: flex-start; }
        .detail-list li i { color: var(--accent); margin-right: 8px; margin-top: 5px; font-size: 0.5rem; }
        .detail-example { display: block; font-style: italic; color: #999; font-size: 0.8rem; margin-top: 3px; }

        /* Quiz Styles */
        .quiz-container { max-width: 800px; margin: 0 auto; }
        .quiz-progress { margin-bottom: 1.5rem; color: #666; font-weight: 700; text-align: right; }
        .quiz-card-q { background: white; border-radius: 8px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .quiz-question { font-size: 1.2rem; font-weight: 700; color: var(--primary); margin-bottom: 1.5rem; border-left: 4px solid var(--accent); padding-left: 20px; line-height: 1.6; }
        .quiz-options { display: grid; gap: 12px; }
        .quiz-option { padding: 15px 20px; background: white; border: 2px solid #eef2f5; border-radius: 8px; cursor: pointer; transition: 0.2s; font-weight: 600; text-align: left; font-size: 1rem; }
        .quiz-option:hover:not(.disabled) { border-color: var(--primary); background: #fdf2f2; }
        .quiz-option.correct { background-color: var(--correct-bg); border-color: #28a745; color: var(--correct-text); }
        .quiz-option.incorrect { background-color: var(--wrong-bg); border-color: #dc3545; color: var(--wrong-text); opacity: 0.8; }
        .quiz-option.disabled { cursor: default; pointer-events: none; }
        
        .quiz-explanation { margin-top: 20px; padding: 15px; background: rgba(212, 175, 55, 0.1); border-radius: 8px; border-left: 4px solid var(--accent); display: none; }
        .next-btn { margin-top: 20px; background: linear-gradient(135deg, var(--accent), #c5a028); color: white; border: none; padding: 10px 25px; border-radius: 30px; cursor: pointer; display: none; font-weight: bold; box-shadow: 0 4px 10px rgba(212, 175, 55, 0.3); }
        
        .score-circle { width: 140px; height: 140px; background: linear-gradient(135deg, var(--primary), #b35a66); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 2rem; color: white; font-size: 3rem; font-weight: 800; box-shadow: 0 10px 30px rgba(128, 0, 32, 0.3); border: 4px solid rgba(255, 255, 255, 0.2); }

        @keyframes pulse { 0%, 100% { box-shadow: 0 0 50px rgba(128, 0, 32, 0.4); } 50% { box-shadow: 0 0 70px rgba(128, 0, 32, 0.7); } }
        
        @media (max-width: 768px) {
            .qa-pair { flex-direction: column; gap: 10px; }
            .elegant-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div id="mindmap-container">
        <svg class="connections" id="lines-svg"></svg>
        
        <div class="central-node">
            <div class="central-title">Shirley's Exclamation</div>
            <div class="central-sub">æ„Ÿå˜†å¥</div>
        </div>

        <div class="satellite" onclick="openModal('intro')">
            <i class="fas fa-book-open"></i>
            <div>æ¦‚è«–èˆ‡ä»‹ç´¹<br><span>Introduction</span></div>
        </div>
        <div class="satellite" onclick="openModal('how')">
            <i class="fas fa-bolt"></i>
            <div>How æ„Ÿå˜†å¥<br><span>How Pattern</span></div>
        </div>
        <div class="satellite" onclick="openModal('what')">
            <i class="fas fa-star"></i>
            <div>What æ„Ÿå˜†å¥<br><span>What Pattern</span></div>
        </div>
        <div class="satellite" onclick="openModal('so-such')">
            <i class="fas fa-heart"></i>
            <div>So/Such<br><span>Emphasis</span></div>
        </div>
        <div class="satellite quiz-node" onclick="openModal('quiz')">
            <i class="fas fa-pencil-alt"></i>
            <div>è‡ªæˆ‘æª¢æ¸¬<br><span>Quiz (20)</span></div>
        </div>
    </div>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-card">
            <header class="modal-header">
                <div class="modal-title"><h2>Shirley's Exclamation Platform</h2></div>
                <button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
            </header>
            <nav class="modal-tabs" id="modal-tabs"></nav>
            <div class="modal-body" id="modal-content"></div>
        </div>
    </div>

    <script>
        // --- 1. CONTENT DATA ---
        const contentData = {
            intro: {
                title: "æ¦‚è«–èˆ‡ä»‹ç´¹",
                html: `
                <div class="elegant-wrapper">
                    <h2 class="elegant-title">The Power of Emotion</h2>
                    <span class="elegant-subtitle">Part II: Exclamation Â· æ„Ÿå˜†å¥ç²¾è¯</span>

                    <div class="elegant-grid">
                        <div class="elegant-card">
                            <div class="elegant-icon-box"><i class="fas fa-bolt"></i></div>
                            <h3 class="card-heading">Intensity & Manner</h3>
                            <p class="card-text"><strong>How</strong> å¼·èª¿æ€§è³ªæˆ–ç‹€æ…‹çš„ç¨‹åº¦ï¼Œèšç„¦æ–¼å½¢å®¹è©æˆ–å‰¯è©å¸¶ä¾†çš„æ„Ÿå—ã€‚</p>
                            <div class="divider-line"></div>
                            <ul class="detail-list">
                                <li><i class="fas fa-circle"></i> <div><strong>Structure:</strong> How + Adj/Adv + S + V!<span class="detail-example">"How beautiful she is!" <button class="audio-btn" onclick="speak('How beautiful she is!')"><i class="fas fa-volume-up"></i></button></span></div></li>
                            </ul>
                        </div>

                        <div class="elegant-card">
                            <div class="elegant-icon-box"><i class="fas fa-star"></i></div>
                            <h3 class="card-heading">Object & Essence</h3>
                            <p class="card-text"><strong>What</strong> å¼·èª¿åè©æœ¬èº«ï¼Œå°äººæˆ–äº‹ç‰©æ•´é«”ç™¼å‡ºè®šå˜†ã€‚</p>
                            <div class="divider-line"></div>
                            <ul class="detail-list">
                                <li><i class="fas fa-circle"></i> <div><strong>Structure:</strong> What + (a/an) + N!<span class="detail-example">"What a lovely day!" <button class="audio-btn" onclick="speak('What a lovely day!')"><i class="fas fa-volume-up"></i></button></span></div></li>
                            </ul>
                        </div>

                        <div class="elegant-card">
                            <div class="elegant-icon-box"><i class="fas fa-heart"></i></div>
                            <h3 class="card-heading">Colloquial Emphasis</h3>
                            <p class="card-text">åœ¨å£èªä¸­ï¼Œ<strong>So</strong> èˆ‡ <strong>Such</strong> å¸¸è¢«ç”¨ä¾†æ›¿ä»£æ­£å¼æ„Ÿå˜†å¥ï¼Œèªæ°£æ›´è‡ªç„¶è¦ªåˆ‡ã€‚</p>
                            <div class="divider-line"></div>
                            <ul class="detail-list">
                                <li><i class="fas fa-circle"></i> <div><strong>So/Such:</strong> å¦‚æ­¤... / çœŸæ˜¯...<span class="detail-example">"You are so kind!" <button class="audio-btn" onclick="speak('You are so kind!')"><i class="fas fa-volume-up"></i></button></span></div></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <h2>æ„Ÿå˜†å¥åŸºç¤ä»‹ç´¹ | Basic Introduction</h2>
                <div class="card">
                    <h3>ä»€éº¼æ˜¯æ„Ÿå˜†å¥ï¼Ÿ | What are Exclamations?</h3>
                    <p>æ„Ÿå˜†å¥æ˜¯ç”¨ä¾†è¡¨é”å¼·çƒˆæƒ…æ„Ÿçš„å¥å­ï¼Œå¦‚é©šè¨ã€å–œæ‚…ã€æ†¤æ€’ã€è®šç¾ç­‰ã€‚åœ¨è‹±èªä¸­ï¼Œæ„Ÿå˜†å¥é€šå¸¸ä»¥æ„Ÿå˜†è™Ÿ(!)çµå°¾ã€‚</p>
                    <div class="example">
                        <p><strong>Example:</strong> <span class="highlight">How beautiful the girl is!</span> (é€™å€‹å¥³å­©å¤šéº¼æ¼‚äº®å•Šï¼) <button class="audio-btn" onclick="speak('How beautiful the girl is!')"><i class="fas fa-volume-up"></i></button></p>
                        <p><strong>Example:</strong> <span class="highlight">What a beautiful girl she is!</span> (å¥¹æ˜¯ä¸€å€‹å¤šéº¼æ¼‚äº®çš„å¥³å­©å•Šï¼) <button class="audio-btn" onclick="speak('What a beautiful girl she is!')"><i class="fas fa-volume-up"></i></button></p>
                    </div>
                </div>`
            },
            how: {
                title: "How æ„Ÿå˜†å¥",
                html: `
                <h2>How æ„Ÿå˜†å¥ | How Exclamations</h2>
                
                <div class="card">
                    <h3>çµæ§‹è§£æ | Structure Analysis</h3>
                    <p>How æ„Ÿå˜†å¥çš„æ ¸å¿ƒåœ¨æ–¼å¼·èª¿<strong>å½¢å®¹è© (Adjective)</strong> æˆ– <strong>å‰¯è© (Adverb)</strong>ã€‚</p>
                    
                    <div class="structure-box">
                        <div class="structure-title">How Pattern</div>
                        <div class="structure-content">How + Adj./Adv. + S + V + !</div>
                    </div>
                    
                    <div class="example">
                        <p><span class="highlight">How slowly</span> the snail is crawling! (é€™éš»è¸ç‰›çˆ¬å¾—å¤šæ…¢å•Šï¼) <button class="audio-btn" onclick="speak('How slowly the snail is crawling!')"><i class="fas fa-volume-up"></i></button></p>
                    </div>
                    <div class="example">
                        <p><span class="highlight">How famous</span> Hemingway was! (æµ·æ˜å¨æ˜¯å¤šéº¼æœ‰åå•Šï¼) <button class="audio-btn" onclick="speak('How famous Hemingway was!')"><i class="fas fa-volume-up"></i></button></p>
                    </div>
                </div>
                
                <div class="card">
                    <h3>å¥å‹è½‰æ› | Conversion</h3>
                    <div class="qa-pair">
                        <div class="question">
                            <strong>é™³è¿°å¥ (Declarative)</strong><br>
                            The girl is <span style="color:var(--primary)">very beautiful</span>. <button class="audio-btn" onclick="speak('The girl is very beautiful.')"><i class="fas fa-volume-up"></i></button>
                        </div>
                        <div class="answer">
                            <strong>æ„Ÿå˜†å¥ (Exclamation)</strong><br>
                            <span style="color:var(--primary)">How beautiful</span> the girl is! <button class="audio-btn" onclick="speak('How beautiful the girl is!')"><i class="fas fa-volume-up"></i></button>
                        </div>
                    </div>
                </div>`
            },
            what: {
                title: "What æ„Ÿå˜†å¥",
                html: `
                <h2>What æ„Ÿå˜†å¥ | What Exclamations</h2>
                
                <div class="card">
                    <h3>çµæ§‹è§£æ | Structure Analysis</h3>
                    <p>What æ„Ÿå˜†å¥çš„æ ¸å¿ƒåœ¨æ–¼å¼·èª¿<strong>åè© (Noun)</strong>ã€‚</p>
                    
                    <div class="structure-box">
                        <div class="structure-title">What Pattern</div>
                        <div class="structure-content">What + (a/an) + Adj. + N + S + V + !</div>
                    </div>
                    
                    <div class="note-box">
                        <i class="fas fa-info-circle"></i> <strong>Note:</strong> ç•¶åè©ç‚ºè¤‡æ•¸æˆ–ä¸å¯æ•¸æ™‚ï¼Œçœç•¥ a/anã€‚
                    </div>
                    
                    <div class="example">
                        <p><span class="highlight">What a beautiful girl</span> she is! (å¥¹æ˜¯å€‹å¤šéº¼æ¼‚äº®çš„å¥³å­©ï¼) <button class="audio-btn" onclick="speak('What a beautiful girl she is!')"><i class="fas fa-volume-up"></i></button></p>
                        <p><span class="highlight">What bad weather</span> it is! (å¤©æ°£çœŸç³Ÿï¼ *ä¸å¯æ•¸) <button class="audio-btn" onclick="speak('What bad weather it is!')"><i class="fas fa-volume-up"></i></button></p>
                        <p><span class="highlight">What an interesting movie</span> it was! (é‚£æ˜¯ä¸€éƒ¨å¤šéº¼æœ‰è¶£çš„é›»å½±å•Šï¼) <button class="audio-btn" onclick="speak('What an interesting movie it was!')"><i class="fas fa-volume-up"></i></button></p>
                        <p><span class="highlight">What a fast runner</span> he is! (ä»–æ˜¯å€‹å¤šéº¼å¿«çš„è·‘è€…å•Šï¼) <button class="audio-btn" onclick="speak('What a fast runner he is!')"><i class="fas fa-volume-up"></i></button></p>
                    </div>
                </div>`
            },
            'so-such': {
                title: "So/Such",
                html: `
                <h2>So/Such åŠ å¼·èªæ°£ | Emphasis</h2>
                
                <div class="card">
                    <h3>å£èªä¸­çš„å¼·èª¿ | Colloquial Emphasis</h3>
                    <p>åœ¨æ—¥å¸¸å£èªä¸­ï¼Œæˆ‘å€‘å¸¸ä½¿ç”¨ so å’Œ such ä¾†ä»£æ›¿å®Œæ•´çš„æ„Ÿå˜†å¥çµæ§‹ã€‚</p>
                    
                    <div class="qa-pair">
                        <div class="question" style="background: #fffcf5; border:1px solid var(--accent);">
                            <h4>SO + Adj.</h4>
                            <p>The girl is <span class="highlight">so</span> beautiful. <button class="audio-btn" onclick="speak('The girl is so beautiful.')"><i class="fas fa-volume-up"></i></button></p>
                        </div>
                        <div class="answer" style="background: #fffcf5; border:1px solid var(--accent); color:#444;">
                            <h4>SUCH + Noun</h4>
                            <p>She is <span class="highlight">such</span> a beautiful girl! <button class="audio-btn" onclick="speak('She is such a beautiful girl!')"><i class="fas fa-volume-up"></i></button></p>
                        </div>
                    </div>
                    
                    <div class="example">
                        <p>He runs <span class="highlight">so</span> fast! (ä»–è·‘å¾—å¥½å¿«ï¼) <button class="audio-btn" onclick="speak('He runs so fast!')"><i class="fas fa-volume-up"></i></button></p>
                        <p>He is <span class="highlight">such</span> a fast runner! (ä»–çœŸæ˜¯å€‹è·‘å¾—å¿«çš„è·‘è€…ï¼) <button class="audio-btn" onclick="speak('He is such a fast runner!')"><i class="fas fa-volume-up"></i></button></p>
                    </div>
                </div>`
            },
            quiz: {
                title: "è‡ªæˆ‘æª¢æ¸¬",
                html: `<div id="quiz-interface" class="quiz-container">
                    <div class="quiz-progress">Question <span id="current-question-num">1</span> of 20</div>
                    <div id="quiz-question-container"></div>
                </div>
                <div id="quiz-score" class="quiz-result" style="display: none;">
                    <div class="score-circle" id="score-val">0</div>
                    <h2>Quiz Completed!</h2>
                    <p id="score-msg" style="margin:20px 0; font-size:1.1rem; color:#666;"></p>
                    <button class="next-btn" style="display:inline-block;" onclick="initQuiz()"><i class="fas fa-redo"></i> Restart Quiz</button>
                </div>`
            }
        };

        // --- 2. QUIZ DATA ---
        const quizQuestions = [
            { question: "1. ______ a beautiful day it is!", options: ["How", "What", "So", "Such"], correct: 1, explanation: "<strong>Explanation:</strong> Structure: What + (a) + Adj + Noun + S + V." },
            { question: "2. ______ beautiful the day is!", options: ["How", "What", "So", "Such"], correct: 0, explanation: "<strong>Explanation:</strong> Structure: How + Adj + S + V." },
            { question: "3. ______ clever boy he is!", options: ["What a", "What", "How", "How a"], correct: 0, explanation: "<strong>Explanation:</strong> 'Boy' is a singular countable noun, so 'What a'." },
            { question: "4. ______ fast he runs!", options: ["What", "How", "So", "Such"], correct: 1, explanation: "<strong>Explanation:</strong> 'Fast' is an adverb modifying 'runs', so 'How'." },
            { question: "5. ______ strange news this is!", options: ["What a", "What", "How", "How a"], correct: 1, explanation: "<strong>Explanation:</strong> 'News' is uncountable, so 'What' without 'a'." },
            { question: "6. She is ______ a nice person!", options: ["so", "such", "how", "what"], correct: 1, explanation: "<strong>Explanation:</strong> 'Such' is used before 'a/an + Adjective + Noun'." },
            { question: "7. You are ______ kind!", options: ["so", "such", "what", "how"], correct: 0, explanation: "<strong>Explanation:</strong> 'So' is used before an adjective without a noun." },
            { question: "8. ______ expensive car you have!", options: ["What a", "What an", "How", "So"], correct: 1, explanation: "<strong>Explanation:</strong> 'Expensive' starts with a vowel sound, so 'What an'." },
            { question: "9. ______ lovely flowers these are!", options: ["What a", "What", "How", "So"], correct: 1, explanation: "<strong>Explanation:</strong> 'Flowers' is plural, so 'What' without 'a'." },
            { question: "10. ______ well she sings!", options: ["What", "How", "Such", "What a"], correct: 1, explanation: "<strong>Explanation:</strong> 'Well' is an adverb, so 'How'." },
            { question: "11. Look ______ dirty your hands are!", options: ["what", "how", "so", "such"], correct: 1, explanation: "<strong>Explanation:</strong> How + Adj (dirty) + S + V." },
            { question: "12. ______ a mess!", options: ["How", "What", "So", "Such"], correct: 1, explanation: "<strong>Explanation:</strong> 'What a mess!' is a common exclamation." },
            { question: "13. The weather is ______ bad!", options: ["so", "such", "what", "how"], correct: 0, explanation: "<strong>Explanation:</strong> 'So' modifies the adjective 'bad'." },
            { question: "14. It is ______ bad weather!", options: ["so", "such", "how", "what"], correct: 1, explanation: "<strong>Explanation:</strong> 'Such' modifies the noun phrase 'bad weather'." },
            { question: "15. ______ delicious food!", options: ["What a", "What", "How", "How a"], correct: 1, explanation: "<strong>Explanation:</strong> 'Food' is uncountable, so 'What'." },
            { question: "16. ______ tired I am!", options: ["What", "How", "What a", "Such"], correct: 1, explanation: "<strong>Explanation:</strong> How + Adj (tired) + S + V." },
            { question: "17. ______ an exciting game it was!", options: ["How", "What", "So", "Such"], correct: 1, explanation: "<strong>Explanation:</strong> 'What' with noun phrase 'an exciting game'." },
            { question: "18. ______ they have grown!", options: ["What", "How", "So", "Such"], correct: 1, explanation: "<strong>Explanation:</strong> How + S + V (degree of action)." },
            { question: "19. ______ cold it is today!", options: ["What", "How", "What a", "Such"], correct: 1, explanation: "<strong>Explanation:</strong> How + Adj (cold) + S + V." },
            { question: "20. He is ______ a genius!", options: ["so", "such", "how", "what"], correct: 1, explanation: "<strong>Explanation:</strong> 'Such' emphasizes the noun 'genius'." }
        ];

        // --- 3. SYSTEM LOGIC ---
        function layoutSatellites() {
            const satellites = document.querySelectorAll('.satellite');
            const svg = document.getElementById('lines-svg');
            while (svg.firstChild) svg.removeChild(svg.firstChild);

            const radius = 220; 
            const startAngle = -90; 
            const total = satellites.length;
            const cx = window.innerWidth / 2;
            const cy = window.innerHeight / 2;

            satellites.forEach((sat, i) => {
                const angle = startAngle + (i * (360 / total));
                const rad = angle * (Math.PI / 180);
                const x = Math.cos(rad) * radius;
                const y = Math.sin(rad) * radius;

                sat.style.left = `calc(50% + ${x}px - 65px)`; 
                sat.style.top = `calc(50% + ${y}px - 65px)`;

                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", "50%"); line.setAttribute("y1", "50%");
                line.setAttribute("x2", cx + x); line.setAttribute("y2", cy + y);
                line.classList.add("conn-line");
                svg.appendChild(line);
            });
        }
        
        window.addEventListener('resize', layoutSatellites);
        window.addEventListener('load', layoutSatellites);

        const tabKeys = ['intro', 'how', 'what', 'so-such', 'quiz'];

        function openModal(activeKey) {
            const modal = document.getElementById('modal-overlay');
            const tabsContainer = document.getElementById('modal-tabs');
            
            tabsContainer.innerHTML = tabKeys.map(key => {
                const isQuiz = key === 'quiz';
                return `<button class="tab-btn ${key === activeKey ? 'active' : ''}" 
                        onclick="switchTab('${key}', this)">
                        ${isQuiz ? '<i class="fas fa-pencil-alt"></i> ' : ''}${contentData[key].title}
                        </button>`;
            }).join('');

            loadContent(activeKey);
            modal.classList.add('active');
        }

        function closeModal() { document.getElementById('modal-overlay').classList.remove('active'); }

        function switchTab(key, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            loadContent(key);
        }

        function loadContent(key) {
            const contentDiv = document.getElementById('modal-content');
            contentDiv.innerHTML = contentData[key].html;
            if(key === 'quiz') initQuiz();
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text);
                u.lang = 'en-US'; u.rate = 0.9;
                window.speechSynthesis.speak(u);
            }
        }

        // Quiz Logic
        let currentQIndex = 0;
        let score = 0;
        let answered = false;

        function initQuiz() {
            currentQIndex = 0; score = 0;
            document.getElementById('quiz-interface').style.display = 'block';
            document.getElementById('quiz-score').style.display = 'none';
            showQuestion(0);
        }

        function showQuestion(index) {
            answered = false;
            const container = document.getElementById('quiz-question-container');
            const q = quizQuestions[index];
            
            container.innerHTML = `
                <div class="quiz-card-q">
                    <div class="quiz-question">${q.question}</div>
                    <div class="quiz-options">
                        ${q.options.map((opt, i) => `
                            <div class="quiz-option" onclick="handleAnswer(this, ${i})">${opt}</div>
                        `).join('')}
                    </div>
                    <div class="quiz-explanation" id="explanation">${q.explanation}</div>
                    <button class="next-btn" id="next-btn" onclick="nextQ()">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            `;
            document.getElementById('current-question-num').innerText = index + 1;
        }

        function handleAnswer(btn, selectedIndex) {
            if (answered) return;
            answered = true;
            const q = quizQuestions[currentQIndex];
            const allBtns = document.querySelectorAll('.quiz-option');
            
            if (selectedIndex === q.correct) {
                btn.classList.add('correct');
                score++;
            } else {
                btn.classList.add('incorrect');
                allBtns[q.correct].classList.add('correct');
            }
            
            allBtns.forEach(b => b.classList.add('disabled'));
            document.getElementById('explanation').style.display = 'block';
            document.getElementById('next-btn').style.display = 'inline-block';
        }

        function nextQ() {
            currentQIndex++;
            if (currentQIndex < quizQuestions.length) {
                showQuestion(currentQIndex);
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('quiz-interface').style.display = 'none';
            const resDiv = document.getElementById('quiz-score');
            resDiv.style.display = 'block';
            document.getElementById('score-val').innerText = score;
            const msg = document.getElementById('score-msg');
            
            if (score >= 18) msg.textContent = "Excellent! You mastered Exclamations! ğŸ†";
            else if (score >= 12) msg.textContent = "Good job! Keep practicing. ğŸ‘";
            else msg.textContent = "Review the lessons and try again! ğŸ’ª";
        }
    </script>
</body>
</html>
