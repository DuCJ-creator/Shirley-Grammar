<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Shirley's Nouns | Structured Learning</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;0,700;1,500&family=Inter:wght@400;500;600&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      /* --- æ ¸å¿ƒé…è‰² --- */
      --primary-tone: #3a5a40; /* æ£®æ—æ·±ç¶  */
      --secondary-tone: #c9a972; /* å¾©å¤é‡‘ */
      --text-main: #333333;
      --bg-cream: #faf8f2;
      --highlight-bg: #f0eadd;
      
      /* --- å°ºå¯¸è®Šæ•¸ --- */
      --node-size: 115px; 
      --center-size: 190px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      background-color: var(--bg-cream);
      color: var(--text-main);
      height: 100vh;
      width: 100vw;
      overflow: hidden; /* é˜²æ­¢ä¸»ç•«é¢æ»¾å‹• */
      position: relative;
    }

    /* === 1. èƒŒæ™¯æ¼‚æµ®åè© (Floating Nouns) === */
    .floating-objects {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }
    .float-item {
      position: absolute;
      opacity: 0.12;
      filter: grayscale(20%);
      animation: floatUp 18s infinite linear;
    }
    @keyframes floatUp {
      0% { transform: translateY(110vh) rotate(0deg); }
      100% { transform: translateY(-20vh) rotate(360deg); }
    }

    /* === 2. Mind Map èˆå° (è‡ªé©æ‡‰ä½ˆå±€) === */
    .mindmap-stage {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    /* é€£æ¥ç·š */
    .connections {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      z-index: 1;
    }
    .connection-line {
      stroke: var(--secondary-tone);
      stroke-width: 2;
      stroke-dasharray: 6, 6;
      opacity: 0.4;
    }

    /* æ ¸å¿ƒ Core */
    .core-node {
      width: var(--center-size);
      height: var(--center-size);
      background: var(--primary-tone);
      color: white;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      z-index: 5;
      box-shadow: 0 0 0 12px rgba(58, 90, 64, 0.08), 0 25px 50px rgba(0,0,0,0.25);
      animation: corePulse 5s infinite ease-in-out;
      cursor: default;
      position: relative;
    }
    .core-title { font-family: 'Playfair Display', serif; font-size: 2.2rem; font-weight: 700; line-height: 1; }
    .core-sub { font-size: 0.75rem; letter-spacing: 3px; text-transform: uppercase; margin-top: 10px; color: var(--secondary-tone); }

    @keyframes corePulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }

    /* å­ç¯€é» Satellite */
    .satellite {
      position: absolute;
      width: var(--node-size);
      height: var(--node-size);
      border-radius: 50%;
      background: white;
      border: 2px solid var(--primary-tone);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      cursor: pointer;
      z-index: 5;
      box-shadow: 0 10px 25px rgba(58, 90, 64, 0.1);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--primary-tone);
      padding: 5px;
    }
    
    .satellite:hover {
      transform: scale(1.15);
      background: var(--primary-tone);
      color: white;
      border-color: var(--secondary-tone);
      box-shadow: 0 15px 35px rgba(58, 90, 64, 0.3);
      z-index: 10;
    }

    /* é †åºç·¨è™Ÿ Badge */
    .step-badge {
      position: absolute;
      top: -5px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--secondary-tone);
      color: white;
      font-family: 'Inter', sans-serif;
      font-size: 0.8rem;
      font-weight: 700;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .satellite.quiz-node {
      border-color: var(--secondary-tone);
      background: #fffcf5;
    }
    .satellite.quiz-node .step-badge {
      background: #d32f2f; /* æ¸¬é©—ç”¨ç´…è‰²å¼·èª¿ */
    }

    /* === 3. Modal å…§å®¹å€ (RWD Optimized) === */
    .modal-overlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(250, 248, 242, 0.92);
      backdrop-filter: blur(6px);
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .modal-overlay.active { opacity: 1; pointer-events: auto; }

    .modal-content {
      width: 90%;
      max-width: 850px;
      max-height: 85vh;
      background: white;
      border-radius: 16px;
      box-shadow: 0 25px 60px rgba(0,0,0,0.2);
      border-top: 6px solid var(--primary-tone);
      overflow-y: auto; /* å…§å®¹éé•·è‡ªå‹•æ²å‹• */
      padding: 40px;
      display: none;
      animation: slideUp 0.4s ease-out;
    }
    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .close-btn {
      position: absolute;
      top: 20px; right: 20px;
      width: 40px; height: 40px;
      border-radius: 50%;
      border: none;
      background: #f4f4f4;
      font-size: 1.5rem;
      color: var(--text-main);
      cursor: pointer;
      transition: all 0.2s;
    }
    .close-btn:hover { background: var(--secondary-tone); color: white; }

    /* å…§å®¹æ¨£å¼ */
    h2 { font-family: 'Playfair Display', serif; font-size: 2rem; color: var(--primary-tone); margin-bottom: 20px; border-bottom: 2px solid var(--secondary-tone); padding-bottom: 10px; }
    h3 { font-family: 'Playfair Display', serif; font-size: 1.3rem; color: var(--primary-tone); margin: 30px 0 15px; border-left: 4px solid var(--secondary-tone); padding-left: 12px; }
    
    table { width: 100%; border-collapse: collapse; margin: 20px 0; background: #fff; min-width: 100%; }
    .table-responsive { overflow-x: auto; border: 1px solid #e8e4d9; border-radius: 8px; }
    th { background: #f4f1ea; color: var(--primary-tone); padding: 15px; text-align: left; font-family: 'Playfair Display', serif; white-space: nowrap; }
    td { padding: 14px; border-bottom: 1px solid #eee; }
    
    .bilingual-box { display: flex; gap: 20px; background: #fbfbf9; padding: 25px; border-radius: 8px; border: 1px solid #eee; margin-bottom: 20px; }
    .bi-col { flex: 1; }
    .highlight { background: var(--highlight-bg); padding: 2px 6px; border-radius: 4px; color: var(--primary-tone); font-weight: 600; }

    /* Audio */
    .audio-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 15px; margin: 20px 0; }
    .audio-card { border: 1px solid #e8e4d9; padding: 12px; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: all 0.2s; background: white; }
    .audio-card:hover { border-color: var(--secondary-tone); background: #fefcf8; transform: translateY(-2px); }
    .audio-text { font-weight: 600; color: var(--primary-tone); font-size: 0.9rem; }

    /* === Quiz Styles (Enhanced) === */
    .quiz-question-box { background: #fff; padding: 25px; border-radius: 12px; border: 1px solid #eee; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
    .quiz-q-text { font-weight: 700; font-size: 1.2rem; color: var(--primary-tone); margin-bottom: 15px; font-family: 'Playfair Display', serif; }
    .quiz-gap { border-bottom: 2px solid var(--secondary-tone); padding: 0 10px; color: var(--secondary-tone); display: inline-block; min-width: 50px; text-align: center; font-weight: bold; }
    
    .quiz-opt { display: block; width: 100%; padding: 14px 20px; margin-bottom: 10px; border: 2px solid #f0f0f0; border-radius: 8px; background: white; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 1rem; position: relative; }
    .quiz-opt:hover { border-color: var(--secondary-tone); background: #fffbf5; }
    .quiz-opt.correct { background: #e8f5e9; border-color: #4caf50; color: #2e7d32; }
    .quiz-opt.wrong { background: #ffebee; border-color: #ef5350; color: #c62828; }
    .quiz-opt:disabled { cursor: default; }

    .quiz-feedback { margin-top: 10px; font-weight: bold; min-height: 24px; }
    
    .btn-cta { background: var(--secondary-tone); color: white; padding: 10px 24px; border-radius: 50px; border: none; font-size: 1rem; cursor: pointer; display: inline-flex; align-items: center; gap: 8px; margin-top: 20px; transition: 0.3s; font-weight: 600; }
    .btn-cta:hover { background: var(--primary-tone); transform: translateY(-2px); }

    /* Result Card Styles */
    .result-card { text-align: center; padding: 30px; animation: slideUp 0.5s ease-out; }
    .result-score { font-size: 4rem; font-family: 'Playfair Display', serif; color: var(--primary-tone); margin: 20px 0; font-weight: 700; }
    .result-msg { font-size: 1.2rem; color: #666; margin-bottom: 30px; line-height: 1.6; }
    .result-perfect { color: #d32f2f; }

    /* === RWD Mobile Optimization === */
    @media (max-width: 768px) {
      body { overflow-y: auto; height: auto; }
      .floating-objects { height: 100vh; position: fixed; }
      
      /* Mindmap turns into List */
      .mindmap-stage { flex-direction: column; height: auto; padding: 50px 20px; }
      .connections { display: none; }
      .core-node { margin-bottom: 40px; width: 140px; height: 140px; }
      .core-title { font-size: 1.8rem; }
      
      .satellite { 
        position: relative; 
        top: auto !important; left: auto !important; 
        transform: none !important;
        width: 100%; 
        height: auto; 
        min-height: 70px;
        border-radius: 12px;
        padding: 15px 20px;
        margin-bottom: 12px;
        flex-direction: row; 
        justify-content: flex-start;
        text-align: left;
        gap: 20px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      }
      .satellite:hover { transform: translateY(-3px) !important; }
      .step-badge { position: static; transform: none; margin-right: 0; min-width: 24px; }
      
      /* Modal fixes */
      .modal-content { padding: 25px; width: 95%; max-height: 90vh; }
      .bilingual-box { flex-direction: column; }
      h2 { font-size: 1.6rem; }
    }
  </style>
</head>
<body>

  <div class="floating-objects" id="floatingBg"></div>

  <div class="mindmap-stage" id="stage">
    
    <svg class="connections" id="svgLines"></svg>

    <div class="core-node">
      <div class="core-title">Shirley's<br>Nouns</div>
      <div class="core-sub">Start Here â†“</div>
    </div>

    <div class="satellite" data-target="def-modal">
      <div class="step-badge">1</div>
      <div>Definition<br>å®šç¾©</div>
    </div>
    <div class="satellite" data-target="types-modal">
      <div class="step-badge">2</div>
      <div>Types<br>åè©åˆ†é¡</div>
    </div>
    <div class="satellite" data-target="count-modal">
      <div class="step-badge">3</div>
      <div>Countable<br>å¯æ•¸åè©</div>
    </div>
    <div class="satellite" data-target="uncount-modal">
      <div class="step-badge">4</div>
      <div>Uncountable<br>ä¸å¯æ•¸</div>
    </div>
    <div class="satellite" data-target="poss-modal">
      <div class="step-badge">5</div>
      <div>Possessive<br>æ‰€æœ‰æ ¼</div>
    </div>
    <div class="satellite" data-target="art-modal">
      <div class="step-badge">6</div>
      <div>Articles<br>å† è©</div>
    </div>
    <div class="satellite" data-target="clause-modal">
      <div class="step-badge">7</div>
      <div>Noun Clauses<br>åè©å­å¥</div>
    </div>
    <div class="satellite" data-target="mistake-modal">
      <div class="step-badge">8</div>
      <div>Mistakes<br>å¸¸è¦‹éŒ¯èª¤</div>
    </div>
    <div class="satellite quiz-node" data-target="quiz-modal">
      <div class="step-badge">9</div>
      <div>Quiz<br>å¯¦æˆ°æ¼”ç·´</div>
    </div>

  </div>

  <div class="modal-overlay" id="modalOverlay">
    <button class="close-btn" onclick="closeModal()">âœ•</button>

    <div id="def-modal" class="modal-content">
      <h2>1. What is a Noun?</h2>
      <div class="bilingual-box">
        <div class="bi-col">
          A <span class="highlight">noun</span> names a <strong>person, place, thing, or idea</strong>.
        </div>
        <div class="bi-col">
          <span class="highlight">åè©</span>ç”¨ä¾†å‘½å<strong>äººã€åœ°æ–¹ã€äº‹ç‰©æˆ–æ¦‚å¿µ</strong>ã€‚
        </div>
      </div>
    </div>

    <div id="types-modal" class="modal-content">
      <h2>2. Types of Nouns åè©åˆ†é¡</h2>
      <div class="table-responsive">
        <table>
          <thead><tr><th>Type</th><th>ä¸­æ–‡</th><th>Examples</th></tr></thead>
          <tbody>
            <tr><td>Common</td><td>æ™®é€šåè©</td><td>city, teacher, cat</td></tr>
            <tr><td>Proper</td><td>å°ˆæœ‰åè©</td><td>Taipei, Shirley, Google</td></tr>
            <tr><td>Abstract</td><td>æŠ½è±¡åè©</td><td>love, time, freedom</td></tr>
            <tr><td>Collective</td><td>é›†åˆåè©</td><td>team, family, audience</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div id="count-modal" class="modal-content">
      <h2>3. Countable Nouns & Plurals</h2>
      <h3>Irregular Plurals ä¸è¦å‰‡è¤‡æ•¸</h3>
      <div class="audio-grid">
        <div class="audio-card" onclick="speak('man men')"><span class="audio-text">man â†’ men</span><span>ğŸ”Š</span></div>
        <div class="audio-card" onclick="speak('woman women')"><span class="audio-text">woman â†’ women</span><span>ğŸ”Š</span></div>
        <div class="audio-card" onclick="speak('child children')"><span class="audio-text">child â†’ children</span><span>ğŸ”Š</span></div>
        <div class="audio-card" onclick="speak('mouse mice')"><span class="audio-text">mouse â†’ mice</span><span>ğŸ”Š</span></div>
        <div class="audio-card" onclick="speak('tooth teeth')"><span class="audio-text">tooth â†’ teeth</span><span>ğŸ”Š</span></div>
        <div class="audio-card" onclick="speak('fish fish')"><span class="audio-text">fish â†’ fish</span><span>ğŸ”Š</span></div>
      </div>
    </div>

    <div id="uncount-modal" class="modal-content">
      <h2>4. Uncountable Nouns ä¸å¯æ•¸åè©</h2>
      <p>ä¸å¯æ•¸åè©ä¸èƒ½åŠ  sï¼Œé€šå¸¸ä¸åŠ  a/anã€‚</p>
      <div class="table-responsive">
        <table>
          <tr><th>Category</th><th>Examples</th></tr>
          <tr><td>Liquid</td><td>water, milk, coffee</td></tr>
          <tr><td>Material</td><td>wood, gold, paper</td></tr>
          <tr><td>Abstract</td><td>information, advice, knowledge, news</td></tr>
        </table>
      </div>
      <div class="bilingual-box">
        <strong>âš ï¸ æ˜“éŒ¯æé†’ï¼š</strong> News (æ–°è) çœ‹èµ·ä¾†åƒè¤‡æ•¸ï¼Œå…¶å¯¦æ˜¯å–®æ•¸ï¼Information (è³‡è¨Š) æ°¸é ä¸å¯æ•¸ã€‚
      </div>
    </div>

    <div id="poss-modal" class="modal-content">
      <h2>5. Possessive Case æ‰€æœ‰æ ¼</h2>
      <ul>
        <li><strong>'s</strong>: ç”¨æ–¼äºº (Shirley's bag)</li>
        <li><strong>of</strong>: ç”¨æ–¼ç„¡ç”Ÿå‘½ (The legs of the table)</li>
      </ul>
    </div>

    <div id="art-modal" class="modal-content">
      <h2>6. Articles å† è©</h2>
      <p><strong>a/an</strong> (æ³›æŒ‡å–®æ•¸), <strong>the</strong> (ç‰¹æŒ‡), <strong>ç„¡å† è©</strong> (æ³›æŒ‡è¤‡æ•¸/ä¸å¯æ•¸)ã€‚</p>
    </div>

    <div id="clause-modal" class="modal-content">
      <h2>7. Noun Clauses åè©å­å¥</h2>
      <p>å…·åè©åŠŸèƒ½çš„å­å¥ã€‚ <em>"I know <strong>where she lives</strong>."</em></p>
      <a href="https://ducj-creator.github.io/Shirley-Grammar/noun-clause/" target="_blank" class="btn-cta" style="background:var(--primary-tone);">
        ğŸ“˜ æ·±å…¥å­¸ç¿’åè©å­å¥
      </a>
    </div>

    <div id="mistake-modal" class="modal-content">
      <h2>8. Common Mistakes å¸¸è¦‹éŒ¯èª¤</h2>
      <div class="table-responsive">
        <table>
          <tr><th style="color:#c62828">Wrong (X)</th><th style="color:#2e7d32">Right (O)</th><th>Why?</th></tr>
          <tr><td>I like dog.</td><td>I like dogs.</td><td>æ³›æŒ‡ç”¨è¤‡æ•¸</td></tr>
          <tr><td>many informations</td><td>much information</td><td>ä¸å¯æ•¸</td></tr>
          <tr><td>a advice</td><td>some advice</td><td>ä¸å¯æ•¸ä¸èƒ½åŠ a</td></tr>
        </table>
      </div>
    </div>

    <div id="quiz-modal" class="modal-content">
      <h2>9. Nouns Challenge ğŸ†</h2>
      <p style="margin-bottom:25px; color:#666;">Fill in the gaps. Try to get 10/10!</p>
      
      <div id="quiz-area"></div>
      
      <div id="result-area" class="result-card" style="display:none;">
        <h3>Quiz Completed!</h3>
        <div class="result-score" id="score-display">0 / 10</div>
        <div class="result-msg" id="msg-display"></div>
        <button onclick="renderQuiz()" class="btn-cta">
          â†º Retry Quiz
        </button>
      </div>

    </div>

  </div>

  <script>
    // === 1. Floating Nouns Generation ===
    const nounsIcons = ['ğŸ', 'ğŸš—', 'ğŸ¶', 'ğŸ“˜', 'ğŸ ', 'â˜•', 'ğŸ“', 'ğŸ’¡', 'ğŸŒ³', 'ğŸš²', 'â°', 'âœˆï¸'];
    const floatContainer = document.getElementById('floatingBg');

    function createFloatingIcons() {
      for(let i=0; i<15; i++) {
        const el = document.createElement('div');
        el.classList.add('float-item');
        el.innerText = nounsIcons[Math.floor(Math.random() * nounsIcons.length)];
        el.style.left = Math.random() * 100 + 'vw';
        el.style.animationDuration = (18 + Math.random() * 15) + 's';
        el.style.animationDelay = (Math.random() * 5) + 's';
        el.style.fontSize = (1.5 + Math.random() * 2) + 'rem';
        floatContainer.appendChild(el);
      }
    }
    createFloatingIcons();

    // === 2. Mind Map Layout (Circular with Numbers) ===
    function updateLayout() {
      const satellites = document.querySelectorAll('.satellite');
      const stage = document.getElementById('stage');
      const svg = document.getElementById('svgLines');
      const isMobile = window.innerWidth <= 768;

      while(svg.firstChild) svg.removeChild(svg.firstChild);

      if(isMobile) return; 

      const centerX = stage.offsetWidth / 2;
      const centerY = stage.offsetHeight / 2;
      const radius = 270;
      const total = satellites.length;

      satellites.forEach((node, index) => {
        // å¾ 12 é»é˜æ–¹å‘é–‹å§‹é †æ™‚é‡æ’åˆ—
        const angle = (index / total) * 2 * Math.PI - (Math.PI / 2);
        
        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);

        node.style.left = x + 'px';
        node.style.top = y + 'px';
        node.style.transform = 'translate(-50%, -50%)';

        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', centerX);
        line.setAttribute('y1', centerY);
        line.setAttribute('x2', x);
        line.setAttribute('y2', y);
        line.classList.add('connection-line');
        svg.appendChild(line);
      });
    }
    
    window.addEventListener('resize', updateLayout);
    window.addEventListener('load', updateLayout);

    // === 3. Modal Logic ===
    const overlay = document.getElementById('modalOverlay');
    
    document.querySelectorAll('.satellite').forEach(btn => {
      btn.addEventListener('click', () => {
        const targetId = btn.getAttribute('data-target');
        document.querySelectorAll('.modal-content').forEach(c => c.style.display = 'none');
        document.getElementById(targetId).style.display = 'block';
        overlay.classList.add('active');
      });
    });

    function closeModal() {
      overlay.classList.remove('active');
    }
    overlay.addEventListener('click', (e) => { if(e.target === overlay) closeModal(); });

    function speak(text) {
      if ('speechSynthesis' in window) {
        speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        speechSynthesis.speak(utterance);
      }
    }

    // === 4. QUIZ SYSTEM (10 Questions + Summary) ===
    
    let currentScore = 0;
    let answeredCount = 0;

    const quizData = [
      {
        q: "Look at that ______ in the sky!",
        options: ["birds", "bird", "bird's", "a birds"],
        ans: 1 // bird
      },
      {
        q: "The ______ are playing happily in the park.",
        options: ["childs", "childrens", "children", "child"],
        ans: 2 // children
      },
      {
        q: "I need some ______ about the flight.",
        options: ["information", "informations", "an information", "pieces of informations"],
        ans: 0 // information
      },
      {
        q: "Where is ______ car parked?",
        options: ["John", "Johns", "John's", "Johns'"],
        ans: 2 // John's
      },
      {
        q: "The news ______ very shocking today.",
        options: ["are", "were", "is", "have"],
        ans: 2 // is
      },
      {
        q: "Can you give me ______ advice?",
        options: ["an", "some", "many", "a"],
        ans: 1 // some
      },
      {
        q: "There are two ______ on the table.",
        options: ["watch", "watchs", "watches", "watcher"],
        ans: 2 // watches
      },
      {
        q: "My family ______ very supportive.",
        options: ["is", "are", "have", "be"],
        ans: 0 // is (Collective as a unit)
      },
      {
        q: "Please clean up the fallen ______ in the yard.",
        options: ["leafs", "leaves", "leafes", "leavs"],
        ans: 1 // leaves
      },
      {
        q: "Water ______ necessary for life.",
        options: ["are", "have", "were", "is"],
        ans: 3 // is
      }
    ];

    function renderQuiz() {
      const container = document.getElementById('quiz-area');
      const resultArea = document.getElementById('result-area');
      
      // Reset state
      container.innerHTML = ''; 
      container.style.display = 'block';
      resultArea.style.display = 'none';
      currentScore = 0;
      answeredCount = 0;

      quizData.forEach((item, qIdx) => {
        const box = document.createElement('div');
        box.className = 'quiz-question-box';

        // é¡Œç›®é¡¯ç¤º
        const qText = document.createElement('div');
        qText.className = 'quiz-q-text';
        qText.innerHTML = (qIdx+1) + ". " + item.q.replace('______', '<span class="quiz-gap">?</span>');
        box.appendChild(qText);

        const feedback = document.createElement('div');
        feedback.className = 'quiz-feedback';

        item.options.forEach((opt, oIdx) => {
          const btn = document.createElement('button');
          btn.className = 'quiz-opt';
          btn.innerText = opt;
          btn.onclick = function() {
            checkAnswer(this, box, item, oIdx, feedback, qText);
          };
          box.appendChild(btn);
        });

        box.appendChild(feedback);
        container.appendChild(box);
      });
    }

    function checkAnswer(btn, box, item, selectedIdx, feedback, qTextEl) {
      // é–å®šè©²é¡Œæ‰€æœ‰é¸é …
      const allBtns = box.querySelectorAll('.quiz-opt');
      allBtns.forEach(b => b.disabled = true);
      
      answeredCount++;

      if(selectedIdx === item.ans) {
        currentScore++;
        btn.classList.add('correct');
        feedback.innerHTML = "Correct! ğŸ‰";
        feedback.style.color = "#2e7d32";
        
        // Update Gap text
        const gap = qTextEl.querySelector('.quiz-gap');
        gap.innerText = item.options[item.ans];
        gap.style.color = "#2e7d32";
        gap.style.borderBottomColor = "#2e7d32";
      } else {
        btn.classList.add('wrong');
        allBtns[item.ans].classList.add('correct'); // Show correct one
        feedback.innerText = "Oops! Review the rules.";
        feedback.style.color = "#c62828";
        
        const gap = qTextEl.querySelector('.quiz-gap');
        gap.innerText = item.options[item.ans];
        gap.style.color = "#c62828";
      }

      // Check if all answered
      if(answeredCount === quizData.length) {
        // Create a button to show results if user is scrolling
        const showResultBtn = document.createElement('button');
        showResultBtn.innerText = "See Final Results â†’";
        showResultBtn.className = "btn-cta";
        showResultBtn.style.display = "block";
        showResultBtn.style.margin = "30px auto";
        showResultBtn.onclick = showSummary;
        document.getElementById('quiz-area').appendChild(showResultBtn);
        
        // Auto scroll to bottom smoothly
        setTimeout(() => {
          showResultBtn.scrollIntoView({behavior: "smooth"});
        }, 500);
      }
    }

    function showSummary() {
      const container = document.getElementById('quiz-area');
      const resultArea = document.getElementById('result-area');
      const scoreDisplay = document.getElementById('score-display');
      const msgDisplay = document.getElementById('msg-display');

      container.style.display = 'none';
      resultArea.style.display = 'block';
      
      scoreDisplay.innerText = `${currentScore} / ${quizData.length}`;
      
      if(currentScore === quizData.length) {
        msgDisplay.innerHTML = "Perfect Score! ğŸŒŸ<br>You are a Noun Master!";
        msgDisplay.classList.add('result-perfect');
      } else if (currentScore >= 7) {
        msgDisplay.innerText = "Great job! You have a good understanding.";
      } else {
        msgDisplay.innerText = "Keep practicing! Review the notes and try again.";
      }
    }

    // Init
    renderQuiz();

  </script>
</body>
</html>
