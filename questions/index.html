<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shirley's Questions (Radial Design)</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* é…è‰²æ–¹æ¡ˆï¼šRoyal Sapphire (çš‡å®¶è—å¯¶çŸ³) */
            --bg-deep: #f0f7ff;       /* æ¥µæ·ºçš‡å®¶è— */
            --primary: #4169e1;       /* çš‡å®¶è— (Royal Blue) */
            --primary-dark: #1e40af;  /* æ·±è— */
            --accent: #ff6b6b;        /* çŠç‘šç´… (å¼·èª¿è‰²) */
            
            --card-bg: rgba(255, 255, 255, 0.98);
            --shadow-float: 0 10px 40px -10px rgba(65, 105, 225, 0.2);
            --highlight-bg: #e0e7ff;

            /* æ¸¬é©—å°ˆç”¨è‰² */
            --correct-bg: #d4edda;
            --correct-text: #155724;
            --wrong-bg: #f8d7da;
            --wrong-text: #721c24;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Lato', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-deep);
            color: #2c3e50;
            overflow: hidden; 
            height: 100vh; width: 100vw;
        }

        /* --- 1. Radial Mind Map (æ”¾å°„ç‹€é¦–é ) --- */
        #mindmap-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            z-index: 1;
        }

        /* ä¸­å¿ƒç¯€é» */
        .central-node {
            width: 200px; height: 200px;
            background: var(--primary);
            border-radius: 50%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            color: white;
            box-shadow: 0 0 40px rgba(65, 105, 225, 0.5);
            z-index: 10;
            position: relative;
            animation: pulse 3s infinite ease-in-out;
            text-align: center;
            border: 5px solid #bfdbfe;
            cursor: default;
        }

        .central-title { font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 700; line-height: 1.2; }
        .central-sub { font-size: 0.9rem; opacity: 0.9; margin-top: 5px; font-weight: 300; letter-spacing: 1px; }

        /* è¡›æ˜Ÿç¯€é» */
        .satellite {
            position: absolute;
            width: 120px; height: 120px;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 50%;
            color: var(--primary-dark);
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-size: 0.85rem; font-weight: 600;
            z-index: 5;
            padding: 5px;
        }
        
        .satellite i { font-size: 1.8rem; margin-bottom: 5px; color: var(--primary); }
        .satellite span { font-size: 0.7rem; opacity: 0.7; display: block; margin-top: 2px; }

        .satellite:hover {
            transform: scale(1.15) !important;
            background: var(--primary);
            color: white;
            border-color: var(--primary-dark);
            box-shadow: 0 10px 25px rgba(65, 105, 225, 0.4);
            z-index: 20;
        }
        .satellite:hover i { color: white; }

        /* æ¸¬é©—ç¯€é»æ¨£å¼ */
        .satellite.quiz-node { border-color: var(--accent); color: #c0392b; }
        .satellite.quiz-node i { color: var(--accent); }
        .satellite.quiz-node:hover { background: var(--accent); color: white; border-color: #a93226; }
        .satellite.quiz-node:hover i { color: white; }

        /* é€£æ¥ç·š */
        .connections { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; }
        .conn-line { stroke: var(--primary); stroke-width: 1.5; stroke-dasharray: 4,4; opacity: 0.3; }

        /* --- 2. Modal (å…§å®¹å¡ç‰‡) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(30, 64, 175, 0.3);
            backdrop-filter: blur(5px);
            z-index: 100;
            opacity: 0; visibility: hidden;
            transition: all 0.4s ease;
            display: flex; justify-content: center; align-items: center;
        }

        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal-card {
            width: 90%; max-width: 1000px; height: 90vh;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-float);
            display: flex; flex-direction: column;
            overflow: hidden;
            transform: translateY(30px) scale(0.95);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal-overlay.active .modal-card { transform: translateY(0) scale(1); }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), #6495ed);
            color: white;
            padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 3px solid var(--accent);
        }
        
        .modal-title h2 { font-family: 'Playfair Display', serif; font-size: 1.6rem; margin: 0; border: none; padding: 0; color: white; }
        .modal-close { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; transition: 0.3s; }
        .modal-close:hover { transform: rotate(90deg); color: var(--accent); }

        /* åˆ†é å°èˆª */
        .modal-tabs {
            display: flex; background: #e0e7ff; overflow-x: auto;
            border-bottom: 1px solid #c7d2fe; flex-shrink: 0;
        }
        .tab-btn {
            flex: 1; padding: 1rem; border: none; background: none;
            color: var(--primary-dark); font-weight: 600; cursor: pointer;
            transition: 0.3s; min-width: 120px; white-space: nowrap;
            font-family: 'Lato', sans-serif;
            font-size: 0.95rem;
        }
        .tab-btn:hover { background: #c7d2fe; }
        .tab-btn.active { background: white; color: var(--primary); border-bottom: 3px solid var(--primary); }

        /* å…§å®¹æ¨£å¼ (ç§»æ¤è‡ªæ‚¨çš„åŸæª”) */
        .modal-body { flex: 1; overflow-y: auto; padding: 2.5rem; scroll-behavior: smooth; line-height: 1.8; }
        
        h2 { font-family: 'Playfair Display', serif; color: var(--primary); font-size: 1.8rem; border-bottom: 2px solid var(--accent); padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
        h3 { color: #6495ed; font-size: 1.4rem; margin: 2rem 0 1rem 0; font-weight: 700; }
        
        /* è¡¨æ ¼æ¨£å¼ */
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.95rem; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #e0e0e0; }
        th { background-color: var(--primary); color: white; }
        tr:nth-child(even) { background-color: #f8f9fa; }

        /* ä¾‹å¥èˆ‡QAæ¨£å¼ */
        .qa-pair { display: flex; justify-content: space-between; margin: 10px 0; gap: 10px; }
        .question { flex: 1; padding: 12px; background: #f0f7ff; border-radius: 6px; border-left: 4px solid var(--primary); }
        .answer { flex: 1; padding: 12px; background: #e8f5e9; border-radius: 6px; border-left: 4px solid var(--correct-text); }
        
        .example-box { background-color: #f0f7ff; border-left: 4px solid var(--accent); padding: 1rem; margin: 1rem 0; border-radius: 0 8px 8px 0; }
        .highlight { background-color: #fff9e6; padding: 2px 6px; border-radius: 4px; font-weight: bold; color: var(--primary); }

        .audio-btn { background: none; border: none; color: #d4af37; cursor: pointer; margin-left: 8px; font-size: 1.1rem; transition: all 0.2s; }
        .audio-btn:hover { color: var(--primary); transform: scale(1.15); }

        /* Elegant Wrapper (ç§»æ¤æå•è—è¡“) */
        .elegant-wrapper { background-color: #fdfbf7; padding: 2rem; border-radius: 8px; border: 1px solid rgba(0,0,0,0.05); margin-bottom: 2rem; position: relative; }
        .elegant-title { text-align: center; color: #1a1a1a; font-family: 'Playfair Display', serif; border: none; margin-bottom: 0.5rem; }
        .elegant-subtitle { display: block; text-align: center; color: #888; font-style: italic; margin-bottom: 2rem; }
        .elegant-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .elegant-card { background: white; padding: 1.5rem; border-radius: 4px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border: 1px solid #eaeaea; transition: 0.3s; }
        .elegant-card:hover { transform: translateY(-5px); border-color: #d4af37; }
        .elegant-icon { font-size: 1.5rem; color: #d4af37; margin-bottom: 1rem; display: inline-block; width: 50px; height: 50px; line-height: 50px; background: #fffcf5; border-radius: 50%; }

        /* Quiz Styles */
        .quiz-container { max-width: 800px; margin: 0 auto; }
        .quiz-progress { margin-bottom: 1.5rem; color: var(--primary); font-weight: 700; text-align: right; }
        .quiz-card { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .quiz-question { font-size: 1.2rem; font-weight: 700; color: var(--primary); margin-bottom: 1.5rem; border-left: 4px solid #d4af37; padding-left: 15px; }
        .quiz-options { display: grid; gap: 10px; }
        .option-btn { padding: 15px; background: white; border: 2px solid #eef2f5; border-radius: 8px; cursor: pointer; text-align: left; font-size: 1rem; transition: 0.2s; width: 100%; color: #2d3748; }
        .option-btn:hover:not(:disabled) { border-color: var(--primary); background: #f0f7ff; }
        .option-btn.correct { background-color: var(--correct-bg); border-color: #28a745; color: var(--correct-text); }
        .option-btn.incorrect { background-color: var(--wrong-bg); border-color: #dc3545; color: var(--wrong-text); opacity: 0.8; }
        
        .quiz-explanation { margin-top: 20px; padding: 15px; background: #fffcf5; border-left: 4px solid #d4af37; border-radius: 4px; display: none; }
        .next-btn { margin-top: 20px; background-color: var(--accent); color: white; border: none; padding: 10px 25px; border-radius: 30px; cursor: pointer; display: none; font-weight: bold; }
        .score-circle { width: 120px; height: 120px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; font-weight: 800; margin: 0 auto 2rem; }

        @keyframes pulse { 0%, 100% { box-shadow: 0 0 40px rgba(65, 105, 225, 0.5); } 50% { box-shadow: 0 0 60px rgba(65, 105, 225, 0.8); } }
        
        @media (max-width: 768px) {
            .qa-pair { flex-direction: column; }
            .elegant-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div id="mindmap-container">
        <svg class="connections" id="lines-svg"></svg>
        
        <div class="central-node">
            <div class="central-title">Shirley's Questions</div>
            <div class="central-sub">ç–‘å•å¥çµæ§‹</div>
        </div>

        <div class="satellite" onclick="openModal('intro')">
            <i class="fas fa-book-open"></i>
            <div>æ¦‚è«–èˆ‡çµæ§‹<br><span>Introduction</span></div>
        </div>
        <div class="satellite" onclick="openModal('art')">
            <i class="fas fa-magic"></i>
            <div>æå•è—è¡“<br><span>The Art</span></div>
        </div>
        <div class="satellite" onclick="openModal('yesno')">
            <i class="fas fa-check-circle"></i>
            <div>æ˜¯éå•å¥<br><span>Yes/No Qs</span></div>
        </div>
        <div class="satellite" onclick="openModal('wh')">
            <i class="fas fa-question"></i>
            <div>WHå•å¥<br><span>WH Qs</span></div>
        </div>
        <div class="satellite" onclick="openModal('tag')">
            <i class="fas fa-tags"></i>
            <div>é™„åŠ å•å¥<br><span>Tag Qs</span></div>
        </div>
        <div class="satellite quiz-node" onclick="openModal('quiz')">
            <i class="fas fa-pencil-alt"></i>
            <div>è‡ªæˆ‘æª¢æ¸¬<br><span>Quiz (20)</span></div>
        </div>
    </div>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-card">
            <header class="modal-header">
                <div class="modal-title"><h2>Shirley's Questions Platform</h2></div>
                <button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
            </header>
            <nav class="modal-tabs" id="modal-tabs"></nav>
            <div class="modal-body" id="modal-content"></div>
        </div>
    </div>

    <script>
        // --- 1. CONTENT DATA ---
        const contentData = {
            intro: {
                title: "æ¦‚è«–èˆ‡çµæ§‹",
                html: `
                <h2>ç–‘å•å¥åŸºç¤ä»‹ç´¹ (Introduction)</h2>
                <div class="example-box" style="background:white; border-left-color:var(--primary);">
                    <h3>ä»€éº¼æ˜¯ç–‘å•å¥ï¼Ÿ | What are Questions?</h3>
                    <p>ç–‘å•å¥æ˜¯ç”¨ä¾†æå‡ºå•é¡Œçš„å¥å­ï¼Œåœ¨è‹±èªä¸­æœ‰å¤šç¨®å½¢å¼ï¼ŒåŒ…æ‹¬ Yes/No ç–‘å•å¥ã€WH ç–‘å•å¥å’Œé™„åŠ å•å¥ã€‚</p>
                    <div style="margin-top:10px;">
                        <p><strong>Yes/No:</strong> <span class="highlight">Is the actor handsome?</span> <button class="audio-btn" onclick="speak('Is the actor handsome?')"><i class="fas fa-volume-up"></i></button></p>
                        <p><strong>WH:</strong> <span class="highlight">What is he doing?</span> <button class="audio-btn" onclick="speak('What is he doing?')"><i class="fas fa-volume-up"></i></button></p>
                        <p><strong>Tag:</strong> <span class="highlight">You are coming, aren't you?</span> <button class="audio-btn" onclick="speak('You are coming, aren\'t you?')"><i class="fas fa-volume-up"></i></button></p>
                    </div>
                </div>
                
                <h3>ç–‘å•å¥çš„åŸºæœ¬çµæ§‹ | Basic Structure</h3>
                <table>
                    <thead>
                        <tr><th>é¡å‹ Type</th><th>çµæ§‹ Structure</th><th>ä¾‹å­ Example</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Yes/No</td><td>Auxiliary + Subject + ... ?</td><td>Is he a teacher? <button class="audio-btn" onclick="speak('Is he a teacher?')"><i class="fas fa-volume-up"></i></button></td></tr>
                        <tr><td>WH</td><td>WH + Auxiliary + Subject + ... ?</td><td>Where do you live? <button class="audio-btn" onclick="speak('Where do you live?')"><i class="fas fa-volume-up"></i></button></td></tr>
                        <tr><td>Tag</td><td>Statement, + Auxiliary + Subject?</td><td>You like coffee, don't you? <button class="audio-btn" onclick="speak('You like coffee, don\'t you?')"><i class="fas fa-volume-up"></i></button></td></tr>
                    </tbody>
                </table>`
            },
            art: {
                title: "æå•è—è¡“",
                html: `
                <div class="elegant-wrapper">
                    <h2 class="elegant-title">The Art of Inquiry</h2>
                    <span class="elegant-subtitle">Questions Â· ç–‘å•å¥ç²¾è¯</span>
                    <div class="elegant-grid">
                        <div class="elegant-card">
                            <div class="elegant-icon"><i class="fas fa-question"></i></div>
                            <h3>General Inquiry</h3>
                            <p style="color:#666; font-size:0.9rem;">åŸºç¤ç–‘å•å¥æ˜¯é–‹å•Ÿå°è©±çš„é‘°åŒ™ï¼Œç”¨æ–¼ç²å–è³‡è¨Šæˆ–ç¢ºèªäº‹å¯¦ã€‚</p>
                            <hr style="border:0; border-top:1px solid #eee; margin:1rem 0;">
                            <div style="text-align:left; font-size:0.9rem;">
                                <p><i class="fas fa-circle" style="color:#d4af37; font-size:0.5rem; margin-right:5px;"></i> <strong>Yes/No:</strong> ç¢ºèªæ˜¯é<br><span style="color:#888; font-style:italic; margin-left:15px;">"Can you help me?"</span></p>
                                <p><i class="fas fa-circle" style="color:#d4af37; font-size:0.5rem; margin-right:5px;"></i> <strong>WH:</strong> ç²å–ç´°ç¯€<br><span style="color:#888; font-style:italic; margin-left:15px;">"Why is the sky blue?"</span></p>
                            </div>
                        </div>
                        <div class="elegant-card">
                            <div class="elegant-icon"><i class="fas fa-exclamation"></i></div>
                            <h3>Negative Questions</h3>
                            <p style="color:#666; font-size:0.9rem;">å¦å®šç–‘å•å¥å¸¶æœ‰å¼·çƒˆçš„æƒ…æ„Ÿè‰²å½©ï¼Œå¸¸ç”¨æ–¼è¡¨é”é©šè¨æˆ–é æœŸè½ç©ºã€‚</p>
                            <hr style="border:0; border-top:1px solid #eee; margin:1rem 0;">
                            <div style="text-align:left; font-size:0.9rem;">
                                <p><i class="fas fa-circle" style="color:#d4af37; font-size:0.5rem; margin-right:5px;"></i> <strong>Surprise:</strong> è¡¨é”é©šè¨<br><span style="color:#888; font-style:italic; margin-left:15px;">"Don't you like it?"</span></p>
                                <p><i class="fas fa-circle" style="color:#d4af37; font-size:0.5rem; margin-right:5px;"></i> <strong>Agreement:</strong> å°‹æ±‚èªåŒ<br><span style="color:#888; font-style:italic; margin-left:15px;">"Isn't it a lovely day?"</span></p>
                            </div>
                        </div>
                        <div class="elegant-card">
                            <div class="elegant-icon"><i class="fas fa-feather-alt"></i></div>
                            <h3>Rhetorical Questions</h3>
                            <p style="color:#666; font-size:0.9rem;">ä¿®è¾­ç–‘å•å¥ï¼ˆåå•å¥ï¼‰ç„¡éœ€å›ç­”ï¼Œæ—¨åœ¨å¼·èª¿è§€é»æˆ–å¼•ç™¼æ·±æ€ã€‚</p>
                            <hr style="border:0; border-top:1px solid #eee; margin:1rem 0;">
                            <div style="text-align:left; font-size:0.9rem;">
                                <p><i class="fas fa-circle" style="color:#d4af37; font-size:0.5rem; margin-right:5px;"></i> <strong>Emphasis:</strong> å¼·èª¿èªæ°£<br><span style="color:#888; font-style:italic; margin-left:15px;">"Who cares?"</span></p>
                                <p><i class="fas fa-circle" style="color:#d4af37; font-size:0.5rem; margin-right:5px;"></i> <strong>Persuasion:</strong> èªªæœ<br><span style="color:#888; font-style:italic; margin-left:15px;">"What's in a name?"</span></p>
                            </div>
                        </div>
                    </div>
                </div>`
            },
            yesno: {
                title: "Yes/No ç–‘å•å¥",
                html: `
                <h2>Yes/No ç–‘å•å¥ (Yes/No Questions)</h2>
                <p>åŸºæœ¬çµæ§‹ï¼š<strong>Auxiliary (åŠ©å‹•è©/Be) + Subject (ä¸»è©) + ... ?</strong></p>
                
                <div class="qa-pair">
                    <div class="question"><p><strong>Q:</strong> Is the actor handsome? <button class="audio-btn" onclick="speak('Is the actor handsome?')"><i class="fas fa-volume-up"></i></button></p></div>
                    <div class="answer"><p><strong>A:</strong> Yes, he is. / No, he isn't.</p></div>
                </div>
                <div class="qa-pair">
                    <div class="question"><p><strong>Q:</strong> Do you like sushi? <button class="audio-btn" onclick="speak('Do you like sushi?')"><i class="fas fa-volume-up"></i></button></p></div>
                    <div class="answer"><p><strong>A:</strong> Yes, I do. / No, I don't.</p></div>
                </div>
                <div class="qa-pair">
                    <div class="question"><p><strong>Q:</strong> Did Bob buy lunch? <button class="audio-btn" onclick="speak('Did Bob buy lunch?')"><i class="fas fa-volume-up"></i></button></p></div>
                    <div class="answer"><p><strong>A:</strong> Yes, he did. / No, he didn't.</p></div>
                </div>

                <h3>ä¸åŒæ™‚æ…‹è®ŠåŒ– | Different Tenses</h3>
                <table>
                    <thead><tr><th>æ™‚æ…‹ Tense</th><th>çµæ§‹ Structure</th><th>ä¾‹å­ Example</th></tr></thead>
                    <tbody>
                        <tr><td>ç¾åœ¨ç°¡å–®</td><td>Do/Does + S + V...?</td><td>Do you speak English?</td></tr>
                        <tr><td>éå»ç°¡å–®</td><td>Did + S + V...?</td><td>Did you see the movie?</td></tr>
                        <tr><td>ç¾åœ¨é€²è¡Œ</td><td>Be + S + V-ing...?</td><td>Are you studying now?</td></tr>
                        <tr><td>éå»é€²è¡Œ</td><td>Was/Were + S + V-ing...?</td><td>Were you sleeping?</td></tr>
                        <tr><td>ç¾åœ¨å®Œæˆ</td><td>Have/Has + S + p.p...?</td><td>Have you finished?</td></tr>
                        <tr><td>æœªä¾†å¼</td><td>Will + S + V...?</td><td>Will you come?</td></tr>
                    </tbody>
                </table>`
            },
            wh: {
                title: "WH ç–‘å•å¥",
                html: `
                <h2>WH ç–‘å•å¥ (WH Questions)</h2>
                <p>åŸºæœ¬çµæ§‹ï¼š<strong>WH Word + Auxiliary + Subject + ... ?</strong></p>
                
                <div class="example-box">
                    <p><strong>What:</strong> <span class="highlight">What is he doing?</span> (ä»–åœ¨åšä»€éº¼ï¼Ÿ) <button class="audio-btn" onclick="speak('What is he doing?')"><i class="fas fa-volume-up"></i></button></p>
                    <p><strong>When:</strong> <span class="highlight">When do you study?</span> (ä½ ä½•æ™‚è®€æ›¸ï¼Ÿ) <button class="audio-btn" onclick="speak('When do you study?')"><i class="fas fa-volume-up"></i></button></p>
                    <p><strong>Where:</strong> <span class="highlight">Where did you buy that?</span> (ä½ åœ¨å“ªè²·çš„ï¼Ÿ) <button class="audio-btn" onclick="speak('Where did you buy that?')"><i class="fas fa-volume-up"></i></button></p>
                    <p><strong>How:</strong> <span class="highlight">How have you been?</span> (ä½ æœ€è¿‘å¥½å—ï¼Ÿ) <button class="audio-btn" onclick="speak('How have you been?')"><i class="fas fa-volume-up"></i></button></p>
                </div>

                <h3>WH ç–‘å•è©ç¸½æ•´ç†</h3>
                <table>
                    <thead><tr><th>ç–‘å•è©</th><th>ç”¨é€”</th><th>ä¾‹å­</th></tr></thead>
                    <tbody>
                        <tr><td>What</td><td>äº‹ç‰©ã€æ´»å‹•</td><td>What is your name?</td></tr>
                        <tr><td>When</td><td>æ™‚é–“</td><td>When is your birthday?</td></tr>
                        <tr><td>Where</td><td>åœ°é»</td><td>Where do you live?</td></tr>
                        <tr><td>Why</td><td>åŸå› </td><td>Why are you late?</td></tr>
                        <tr><td>Who</td><td>äºº (ä¸»æ ¼)</td><td>Who is that man?</td></tr>
                        <tr><td>Whom</td><td>äºº (å—æ ¼)</td><td>Whom did you meet?</td></tr>
                        <tr><td>Whose</td><td>æ‰€æœ‰æ¬Š</td><td>Whose book is this?</td></tr>
                        <tr><td>Which</td><td>é¸æ“‡</td><td>Which one do you prefer?</td></tr>
                        <tr><td>How</td><td>æ–¹å¼ã€ç‹€æ…‹</td><td>How are you feeling?</td></tr>
                        <tr><td>How many</td><td>æ•¸é‡ (å¯æ•¸)</td><td>How many students?</td></tr>
                        <tr><td>How much</td><td>æ•¸é‡ (ä¸å¯æ•¸)</td><td>How much water?</td></tr>
                    </tbody>
                </table>`
            },
            tag: {
                title: "é™„åŠ å•å¥",
                html: `
                <h2>é™„åŠ å•å¥ (Tag Questions)</h2>
                <p>ç”±ã€Œç›´è¿°å¥ã€åŠ ä¸Šä¸€å€‹ç°¡çŸ­çš„å•å¥çµ„æˆã€‚<strong>ç‰¹é»ï¼šå‰è‚¯å¾Œå¦ï¼Œå‰å¦å¾Œè‚¯ã€‚</strong></p>
                
                <h3>1. è‚¯å®šé™³è¿° + å¦å®šé™„åŠ </h3>
                <div class="qa-pair">
                    <div class="question"><p>You are coming, <span class="highlight">aren't you</span>? <button class="audio-btn" onclick="speak('You are coming, aren\'t you?')"><i class="fas fa-volume-up"></i></button></p></div>
                    <div class="answer"><p>Yes, I am. / No, I'm not.</p></div>
                </div>
                <div class="qa-pair">
                    <div class="question"><p>We have finished, <span class="highlight">haven't we</span>? <button class="audio-btn" onclick="speak('We have finished, haven\'t we?')"><i class="fas fa-volume-up"></i></button></p></div>
                    <div class="answer"><p>Yes, we have. / No, we haven't.</p></div>
                </div>

                <h3>2. å¦å®šé™³è¿° + è‚¯å®šé™„åŠ </h3>
                <div class="qa-pair">
                    <div class="question"><p>It isn't raining, <span class="highlight">is it</span>? <button class="audio-btn" onclick="speak('It isn\'t raining, is it?')"><i class="fas fa-volume-up"></i></button></p></div>
                    <div class="answer"><p>Yes, it is. / No, it isn't.</p></div>
                </div>
                <div class="qa-pair">
                    <div class="question"><p>You don't like coffee, <span class="highlight">do you</span>? <button class="audio-btn" onclick="speak('You don\'t like coffee, do you?')"><i class="fas fa-volume-up"></i></button></p></div>
                    <div class="answer"><p>Yes, I do. / No, I don't.</p></div>
                </div>

                <h3>ç‰¹æ®Šæƒ…æ³ (Special Cases)</h3>
                <div class="example-box">
                    <p><strong>1. å¦å®šå‰¯è© (hardly, seldom...)ï¼š</strong> è¦–ç‚ºå¦å®šå¥ï¼Œé™„åŠ å¥ç”¨è‚¯å®šã€‚</p>
                    <p>She <span class="highlight">seldom</span> calls her parents, <span class="highlight">does she</span>? <button class="audio-btn" onclick="speak('She seldom calls her parents, does she?')"><i class="fas fa-volume-up"></i></button></p>
                    <br>
                    <p><strong>2. I am çš„ç”¨æ³•ï¼š</strong></p>
                    <p>I'm never on time, <span class="highlight">am I</span>? (å‰å¦å¾Œè‚¯ï¼Œæ­£å¸¸)</p>
                    <p>I'm going to receive an email, <span class="highlight">aren't I</span>? (å‰è‚¯å¾Œå¦ï¼Œç‰¹æ®Š)</p>
                </div>`
            },
            quiz: {
                title: "è‡ªæˆ‘æª¢æ¸¬",
                html: `<div id="quiz-interface" class="quiz-container">
                    <div class="quiz-progress">Question <span id="current-question-num">1</span> of 20</div>
                    <div class="quiz-card">
                        <div class="quiz-question" id="question-text"></div>
                        <div class="quiz-options" id="options-container"></div>
                        <div class="quiz-explanation" id="quiz-explanation"></div>
                        <button class="next-btn" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ (Next) <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
                <div id="quiz-score" class="quiz-container" style="display: none; text-align:center;">
                    <div class="quiz-card">
                        <div class="score-circle" id="score-val">0</div>
                        <h2>Quiz Completed!</h2>
                        <p id="score-msg" style="margin:20px 0; font-size:1.1rem;"></p>
                        <button class="next-btn" style="display:inline-block;" onclick="initQuiz()"><i class="fas fa-redo"></i> Restart Quiz</button>
                    </div>
                </div>`
            }
        };

        // --- 2. QUIZ DATA (100% Original) ---
        const quizData = [
            { q: "1. ______ you like pizza?", options: ["Are", "Do", "Does", "Is"], correct: 1, exp: "<strong>Explanation:</strong> 'Do' is used with 'you' in present simple questions." },
            { q: "2. ______ she play the piano?", options: ["Do", "Does", "Is", "Are"], correct: 1, exp: "<strong>Explanation:</strong> 'Does' is used with 'she' (third person singular) in present simple questions." },
            { q: "3. ______ they coming to the party?", options: ["Do", "Did", "Are", "Have"], correct: 2, exp: "<strong>Explanation:</strong> 'Are' is used with 'they' in present continuous questions (Are + V-ing)." },
            { q: "4. ______ you finished your homework?", options: ["Did", "Have", "Are", "Do"], correct: 1, exp: "<strong>Explanation:</strong> 'Have' is used to form the present perfect tense (Have + Past Participle)." },
            { q: "5. ______ he go to school yesterday?", options: ["Do", "Does", "Did", "Was"], correct: 2, exp: "<strong>Explanation:</strong> 'Did' is used for past simple questions." },
            { q: "6. ______ is your name?", options: ["Who", "What", "Where", "When"], correct: 1, exp: "<strong>Explanation:</strong> 'What' is used to ask about things or names." },
            { q: "7. ______ do you live?", options: ["Who", "What", "Where", "When"], correct: 2, exp: "<strong>Explanation:</strong> 'Where' is used to ask about places." },
            { q: "8. ______ is that man?", options: ["Who", "What", "Where", "When"], correct: 0, exp: "<strong>Explanation:</strong> 'Who' is used to ask about people." },
            { q: "9. ______ time is it?", options: ["Who", "What", "Where", "How"], correct: 1, exp: "<strong>Explanation:</strong> 'What time' is the correct phrase to ask about time." },
            { q: "10. ______ are you crying?", options: ["Who", "What", "Where", "Why"], correct: 3, exp: "<strong>Explanation:</strong> 'Why' is used to ask for a reason." },
            { q: "11. You are a student, ______?", options: ["aren't you", "don't you", "are you", "do you"], correct: 0, exp: "<strong>Explanation:</strong> Positive statement ('You are') -> Negative tag ('aren't you')." },
            { q: "12. She likes apples, ______?", options: ["isn't she", "doesn't she", "don't she", "didn't she"], correct: 1, exp: "<strong>Explanation:</strong> Positive statement with 'likes' (present simple) -> Negative tag with 'doesn't'." },
            { q: "13. He didn't go to the park, ______?", options: ["did he", "didn't he", "does he", "doesn't he"], correct: 0, exp: "<strong>Explanation:</strong> Negative statement ('didn't go') -> Positive tag ('did he')." },
            { q: "14. They can swim, ______?", options: ["can they", "can't they", "do they", "don't they"], correct: 1, exp: "<strong>Explanation:</strong> Positive statement with modal 'can' -> Negative tag 'can't they'." },
            { q: "15. It isn't raining, ______?", options: ["is it", "isn't it", "does it", "doesn't it"], correct: 0, exp: "<strong>Explanation:</strong> Negative statement ('isn't') -> Positive tag ('is it')." },
            { q: "16. You have finished, ______?", options: ["haven't you", "don't you", "didn't you", "have you"], correct: 0, exp: "<strong>Explanation:</strong> Positive statement with auxiliary 'have' -> Negative tag 'haven't you'." },
            { q: "17. Let's go for a walk, ______?", options: ["will we", "shall we", "do we", "don't we"], correct: 1, exp: "<strong>Explanation:</strong> 'Let's' takes the tag 'shall we'." },
            { q: "18. Don't be late, ______?", options: ["will you", "do you", "don't you", "are you"], correct: 0, exp: "<strong>Explanation:</strong> Imperatives (commands) usually take 'will you' as a tag." },
            { q: "19. There is a book on the table, ______?", options: ["isn't there", "is there", "isn't it", "is it"], correct: 0, exp: "<strong>Explanation:</strong> 'There is' -> tag 'isn't there'." },
            { q: "20. I am right, ______?", options: ["amn't I", "aren't I", "am I not", "don't I"], correct: 1, exp: "<strong>Explanation:</strong> 'I am' takes the special tag 'aren't I' in negative tags." }
        ];

        // --- 3. SYSTEM LOGIC ---
        function layoutSatellites() {
            const satellites = document.querySelectorAll('.satellite');
            const svg = document.getElementById('lines-svg');
            while (svg.firstChild) svg.removeChild(svg.firstChild);

            const radius = 240; 
            const startAngle = -90; 
            const total = satellites.length;
            const cx = window.innerWidth / 2;
            const cy = window.innerHeight / 2;

            satellites.forEach((sat, i) => {
                const angle = startAngle + (i * (360 / total));
                const rad = angle * (Math.PI / 180);
                const x = Math.cos(rad) * radius;
                const y = Math.sin(rad) * radius;

                sat.style.left = `calc(50% + ${x}px - 65px)`; 
                sat.style.top = `calc(50% + ${y}px - 65px)`;

                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", "50%"); line.setAttribute("y1", "50%");
                line.setAttribute("x2", cx + x); line.setAttribute("y2", cy + y);
                line.classList.add("conn-line");
                svg.appendChild(line);
            });
        }
        
        window.addEventListener('resize', layoutSatellites);
        window.addEventListener('load', layoutSatellites);

        const tabKeys = ['intro', 'art', 'yesno', 'wh', 'tag', 'quiz'];

        function openModal(activeKey) {
            const modal = document.getElementById('modal-overlay');
            const tabsContainer = document.getElementById('modal-tabs');
            
            tabsContainer.innerHTML = tabKeys.map(key => {
                const isQuiz = key === 'quiz';
                return `<button class="tab-btn ${key === activeKey ? 'active' : ''}" 
                        onclick="switchTab('${key}', this)">
                        ${isQuiz ? '<i class="fas fa-pencil-alt"></i> ' : ''}${contentData[key].title}
                        </button>`;
            }).join('');

            loadContent(activeKey);
            modal.classList.add('active');
        }

        function closeModal() { document.getElementById('modal-overlay').classList.remove('active'); }

        function switchTab(key, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            loadContent(key);
        }

        function loadContent(key) {
            const contentDiv = document.getElementById('modal-content');
            contentDiv.innerHTML = contentData[key].html;
            if(key === 'quiz') initQuiz();
        }

        function speakText(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text);
                u.lang = 'en-US'; u.rate = 0.9;
                window.speechSynthesis.speak(u);
            }
        }

        // Quiz Logic
        let currentQIndex = 0;
        let score = 0;
        let answered = false;

        function initQuiz() {
            currentQIndex = 0; score = 0;
            document.getElementById('quiz-interface').style.display = 'block';
            document.getElementById('quiz-score').style.display = 'none';
            loadQuestion();
        }

        function loadQuestion() {
            answered = false;
            const data = quizData[currentQIndex];
            document.getElementById('current-question-num').textContent = currentQIndex + 1;
            document.getElementById('question-text').innerText = data.q;
            
            const optionsDiv = document.getElementById('options-container');
            optionsDiv.innerHTML = '';
            document.getElementById('quiz-explanation').style.display = 'none';
            document.getElementById('next-btn').style.display = 'none';

            data.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = opt;
                btn.onclick = () => checkAnswer(index, btn);
                optionsDiv.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, btnElement) {
            if (answered) return;
            answered = true;
            const data = quizData[currentQIndex];
            const isCorrect = selectedIndex === data.correct;
            const options = document.getElementsByClassName('option-btn');
            
            if (isCorrect) {
                btnElement.classList.add('correct');
                score++;
            } else {
                btnElement.classList.add('incorrect');
                options[data.correct].classList.add('correct');
            }
            
            const expDiv = document.getElementById('quiz-explanation');
            expDiv.innerHTML = data.exp;
            expDiv.style.display = 'block';

            for(let btn of options) btn.disabled = true;
            document.getElementById('next-btn').style.display = 'inline-block';
        }

        function nextQuestion() {
            currentQIndex++;
            if (currentQIndex < quizData.length) {
                loadQuestion();
            } else {
                showFinalScore();
            }
        }

        function showFinalScore() {
            document.getElementById('quiz-interface').style.display = 'none';
            document.getElementById('quiz-score').style.display = 'block';
            document.getElementById('score-val').textContent = score;
            const msg = document.getElementById('score-msg');
            
            if (score >= 18) msg.textContent = "Excellent! You mastered Questions! ğŸ†";
            else if (score >= 12) msg.textContent = "Good job! Keep practicing. ğŸ‘";
            else msg.textContent = "Review the lessons and try again! ğŸ’ª";
        }
    </script>
</body>
</html>
